<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="慢慢的脚步">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="慢慢的脚步">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="慢慢的脚步">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>慢慢的脚步</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">慢慢的脚步</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/12/14/工作记录/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zhoufan23">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="慢慢的脚步">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/14/工作记录/" itemprop="url">未命名</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-14T21:21:36+08:00">
                2017-12-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#工作记录</p>
<p>@(工作)[计划, 落地, 思考]</p>
<p>##20171211-20171215</p>
<p>###1214</p>
<ul>
<li style="list-style: none"><input type="checkbox"> webhook：配置gitlab事件机制，等待push，memrge通知</li>
<li><p>[ ] joker.yml</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">version: <span class="number">2.0</span> <span class="comment">#joker版本</span></span><br><span class="line">base_image: python2:v3 <span class="comment">#容器中是空的，需要配置python/java等开发环境，系统版本等</span></span><br><span class="line">deps: <span class="comment">#依赖的底层库</span></span><br><span class="line">  - thrift-compiler</span><br><span class="line">  - libsasl2-dev</span><br><span class="line">build: <span class="comment">#编译命令</span></span><br><span class="line">  - buildout</span><br><span class="line"></span><br><span class="line">test: <span class="comment">#测试依赖和执行环境</span></span><br><span class="line">  deps:</span><br><span class="line">    - mysql:<span class="number">5.6</span></span><br><span class="line"></span><br><span class="line">  unittest:</span><br><span class="line">    - bin/test --with-xunit --with-coverage --cover-xml --cover-html --cover-package=pin --boring-connection=mysql://$MYSQL_USERNAME:$MYSQL_PASSWORD@$MYSQL_HOST/$MYSQL_DATABASE?charset=utf8</span><br><span class="line"></span><br><span class="line">artifacts: <span class="comment">#部署 docker,tarball(物理机)</span></span><br><span class="line">  targets:</span><br><span class="line">    - docker</span><br></pre></td></tr></table></figure>
</li>
<li><p>[ ] 构建流程图<br><img src="./graphviz-0fbc6377bdf1f89d115fe8d78e2c969227b9d990.png" alt="Alt text"></p>
</li>
</ul>
<ol>
<li>gitlab拉取代码</li>
<li>构建编译环境</li>
<li>buildout</li>
<li>test</li>
<li>发布</li>
<li>通知</li>
</ol>
<p>###1212</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 梳理B端机构数据报表出错的问题<ul>
<li>定位case的原因<ul>
<li>访问文章的评论数超时抛出异常，任务终止，重试机制也因为错误日志过多没有记录在任务平台的数据库中</li>
<li>只要拿到曝光数据status=1, 但是互动数据，内容数据统计脚本失败也不会影响</li>
</ul>
</li>
<li>解决方案<ul>
<li>case有两种<ul>
<li>当天数据为0， 小于历史数据，显示负数</li>
<li>当天无数据，status=0，显示’’-‘’</li>
</ul>
</li>
<li>重视监控，有问题第一时间解决</li>
<li>当获取第三方数据超时时抛异常，而不是中断此次任务</li>
<li>任务维度的重试机制优化成用户维度</li>
</ul>
</li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> 品牌提问数据统计中的状态未实时更新<ul>
<li>定位case原因<ul>
<li>按天更新，统计后台的数据表中的激活字段信息每天凌晨从qa获取，两个地方维护，涉及到同步问题</li>
</ul>
</li>
<li>解决方案<ul>
<li>两个地方维护同一份数据，涉及到同步问题，如果没有冷热数据需求，建议在一个地方维护，如果有需求要在两个地方维护，考虑同步方案最小代价实现</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>##20171127-20171201</p>
<p>###1128</p>
<ul>
<li style="list-style: none"><input type="checkbox"> tornado框架<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">application-&gt;httpserver:application</span><br><span class="line">httpserver-&gt;ioloop:监听socket/handle_event</span><br><span class="line">Note right of ioloop:epoll</span><br><span class="line">httpserver-&gt;iostream:客户端socket/ioloop</span><br><span class="line">httpserver-&gt;connection:iostream/application</span><br><span class="line">connection-&gt;httprequest:connection</span><br><span class="line">Note right of connection:application.__call__(httprequest)</span><br><span class="line">application-&gt;requesthandler:httprequest</span><br><span class="line">Note right of requesthandler:finish/flush</span><br><span class="line">requesthandler-&gt;httprequest:write</span><br><span class="line">httprequest-&gt;connection:write</span><br><span class="line">connection-&gt;iostream:write</span><br><span class="line"></span><br><span class="line">```  </span><br><span class="line">##20170918-20171117</span><br><span class="line">&gt; mac 才用的utf8编码，excel 程序默认使用gb2313编码，所以，mac导出的excel文件需要转码, iconv -f utf8 -t gb2312 src.csv &gt; dst.csv</span><br><span class="line"></span><br><span class="line">- [ ] 结构化思维</span><br><span class="line">	- 结论先行，以上统下</span><br><span class="line">	- 论据支撑，分门别类，逻辑递进</span><br><span class="line"></span><br><span class="line">- [ ] 价值思考 </span><br><span class="line">- 「用户价值」 </span><br><span class="line">- 「机构价值」 </span><br><span class="line">- 「平台价值」</span><br><span class="line">- 「底层思考」</span><br><span class="line">- 「优先级排序」</span><br><span class="line"></span><br><span class="line">##20170911-20170915</span><br><span class="line">###0913</span><br><span class="line">- [ ] 上线品牌提问列表API</span><br><span class="line"></span><br><span class="line">###0911</span><br><span class="line">- [ ] 查询机构答案在首页的点击量</span><br><span class="line">```sql</span><br><span class="line">SELECT </span><br><span class="line">	base.id.member_id</span><br><span class="line">FROM </span><br><span class="line">	za_streaming_product_zhihu_entry.entry</span><br><span class="line">WHERE p_date=&quot;20170901&quot;</span><br><span class="line">        AND log_type=&quot;Event&quot;</span><br><span class="line">        AND (detail.view.action=&quot;Expand&quot;</span><br><span class="line">        OR detail.view.action=&quot;OpenUrl&quot;)</span><br><span class="line">        AND (extra.content.type=&quot;22357547&quot;</span><br><span class="line">        OR extra.content.parent_token=&quot;22357547&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SELECT  </span><br><span class="line">        count(*),</span><br><span class="line">        count(distinct(uidid))</span><br><span class="line">FROM </span><br><span class="line">    (</span><br><span class="line">        SELECT </span><br><span class="line">            extra.content.token AS tokens,</span><br><span class="line">            base.id.client_id AS uidid,</span><br><span class="line">            p_date,</span><br><span class="line">            extra.content.type</span><br><span class="line">        FROM </span><br><span class="line">            za_streaming_product_zhihu_entry.entry</span><br><span class="line">        WHERE </span><br><span class="line">            p_date=&quot;20170901&quot;</span><br><span class="line">            AND log_type=&quot;Event&quot;</span><br><span class="line">            AND (detail.view.action=&quot;Expand&quot;</span><br><span class="line">            OR detail.view.action=&quot;OpenUrl&quot;)</span><br><span class="line">            AND extra.vertical.type=&quot;Home&quot;</span><br><span class="line">            AND extra.content.type=&quot;Answer&quot;</span><br><span class="line">    )t1</span><br><span class="line">JOIN </span><br><span class="line">    (</span><br><span class="line">        SELECT </span><br><span class="line">            s2.url_token</span><br><span class="line">        FROM </span><br><span class="line">            (</span><br><span class="line">                SELECT</span><br><span class="line">                    old_id</span><br><span class="line">                FROM</span><br><span class="line">                    zhihu_account.account</span><br><span class="line">                WHERE</span><br><span class="line">                    type=1</span><br><span class="line">            )s1</span><br><span class="line">        JOIN</span><br><span class="line">            (</span><br><span class="line">                SELECT</span><br><span class="line">                    url_token,</span><br><span class="line">                    member_id</span><br><span class="line">                FROM</span><br><span class="line">                    zhihu.pure_answer</span><br><span class="line">            )s2</span><br><span class="line">        ON</span><br><span class="line">            s1.old_id=s2.member_id</span><br><span class="line">    )t2</span><br><span class="line">ON</span><br><span class="line">    t1.tokens=t2.url_token</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>##20170904-20170908</p>
<p>###0904-0905</p>
<ul>
<li style="list-style: none"><input type="checkbox" checked> 机构号禁止app端登录提测</li>
<li style="list-style: none"><input type="checkbox" checked> 与wxy老师沟通好task需求，尽量周二上线</li>
<li style="list-style: none"><input type="checkbox" checked> 上线品牌提问报表对内需求</li>
<li style="list-style: none"><input type="checkbox"> 进一步熟悉tornado框架</li>
<li style="list-style: none"><input type="checkbox"> 与社区后端对宝洁第三方监控数据<br>##20170828-20170901<br>###0828-0901</li>
<li style="list-style: none"><input type="checkbox"> 同步排期，提出优先级，确认广告组提供的api接口</li>
<li style="list-style: none"><input type="checkbox"> 品牌提问报表开发复盘<ul>
<li>数据库表的设计<ul>
<li>主键与innode引擎</li>
<li>索引</li>
<li>中文字符数</li>
</ul>
</li>
<li>rpc接口设计</li>
<li>restful接口设计<ul>
<li>以资源的方式组织接口</li>
<li>支持跨域</li>
</ul>
</li>
<li>部分接口沟通不够高效，有些问题没有考虑到<ul>
<li>获取全量品牌提问列表</li>
<li>生效时间</li>
<li>搜索功能</li>
<li>对外列表页详情页等</li>
</ul>
</li>
<li>品牌提问引入第三方监控</li>
<li>登录bug解决</li>
</ul>
</li>
</ul>
<p>##20170821-20170825</p>
<p>###0824</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 添加品牌提问信息表</li>
<li style="list-style: none"><input type="checkbox"> 排查app端机构账号登陆的bug</li>
</ul>
<p>###0823</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 沟通品牌提问生效时间需求</li>
<li style="list-style: none"><input type="checkbox"> 沟通支持token，关键词，品牌搜索品牌提问的需求，以及获取品牌提问列表需求<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    'content': &lt;Storage&#123;</span><br><span class="line">        'detail': &lt;p&gt;25岁前，我们一直觉得自己还是个女孩子，就算买不起橱窗中那条昂贵的裙子，住不起俯瞰城市烟火的大房子，也相信自己能过得更好......若干年后，不知不觉跨入了25岁，相比过去，关于爱情、工作、梦想，你有哪些新的感悟？生活有没有变成你曾经想要的样子？&lt;/p&gt;&lt;p&gt;【活动规则和奖励】&lt;/p&gt;&lt;p&gt;1.在本问题下，我们将根据内容相关度、点赞与评论数量、回答质量等要求，最终选出3个最佳回答，这三位用户将各获得豌豆公主提供的价值888元的豌豆公主现金购物卡。届时会有工作人员私信与大家联系，并将获奖名单公布在本问题描述中。&lt;/p&gt;&lt;p&gt;2.回答征集时间：2017年8月17日至2017年8月22日&lt;/p&gt;&lt;p&gt;【特别说明】&lt;/p&gt;&lt;p&gt;1.我们倡导原创认真的答题精神，请勿提交未经授权的回答，欢迎与豌豆公主一起分享真实的成长故事。&lt;/p&gt;&lt;p&gt;2.参与回答本问题，代表你同意授权豌豆公主使用你的回答内容，使用范围不限于知乎、豌豆公主所有官方网站等平台。如对本说明有异议，可以选择不回答本问题。&lt;/p&gt;&lt;p&gt;3.该活动最终解释权归豌豆公主所有。&lt;/p&gt;,</span><br><span class="line">        'title': 25岁后的女生，你过上想要的生活了吗？</span><br><span class="line">    &#125;&gt;,  </span><br><span class="line">    'meta': &lt;Storage&#123;</span><br><span class="line">        'is_deleted': False,</span><br><span class="line">        'is_anonymous': False,</span><br><span class="line">        'redirect_to': 0,</span><br><span class="line">        'is_locked': False,</span><br><span class="line">        'url_token': 64001232,</span><br><span class="line">        'created_at': 1502879280,</span><br><span class="line">        'updated_at': 1502939254,</span><br><span class="line">        'is_editable': False,</span><br><span class="line">        'is_muted': False,</span><br><span class="line">        'member_id': 94880803,</span><br><span class="line">        'type': 2,</span><br><span class="line">        'id': 17826464,</span><br><span class="line">        'is_normal': True</span><br><span class="line">    &#125;&gt;,</span><br><span class="line">    'content_status': None,</span><br><span class="line">    'related': &lt;Storage&#123;</span><br><span class="line">        'follower_count': 5504,</span><br><span class="line">        'topics': [</span><br><span class="line">            307,</span><br><span class="line">            2250,</span><br><span class="line">            4323,</span><br><span class="line">            10123,</span><br><span class="line">            <span class="number">174812</span></span><br><span class="line">        ],</span><br><span class="line">        'answer_count': 575,</span><br><span class="line">        'downvote_count': 0,</span><br><span class="line">        'collapsed_answer_count': 14</span><br><span class="line">    &#125;&gt;,</span><br><span class="line">    'relationship': None</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>###0822</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 提供品牌提问数据报表对内api接口以及应答内容格式</li>
<li style="list-style: none"><input type="checkbox"> 讨论检索方案，对title 正则匹配，对匹配精确匹配</li>
</ul>
<p>###0821</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 周会汇报上周工作&amp;本周工作排期指定</li>
<li style="list-style: none"><input type="checkbox"> 确认第三方监控技术实现方案，确认排期</li>
</ul>
<p>##20170814-20170818</p>
<p>###0818</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 组织会议讨论宝洁的品牌提问引入第三方监控需求</li>
</ul>
<p>###0817</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 新增机构简介字段完成部署上线</li>
<li style="list-style: none"><input type="checkbox"> review 抓取脚本代码<ul>
<li>hive_job, define_job两个job，提供两个回调函数(成功后处理函数，失败抛异常)</li>
<li>线程池</li>
<li>simplecache</li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> python动态语言的一点认识<ul>
<li>一切皆对象，函数，类，类实例，整数，map，list等</li>
<li>generate, iterator, yield, 装饰器，元类</li>
<li><strong>call</strong>, <strong>name</strong>, <strong>class</strong>, <strong>init</strong>, <strong>new</strong>等</li>
<li>线程池，协程<br>###0816</li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> 数据库改表需求<ul>
<li>git clone zhihu-database，创建分支</li>
<li>python migration.py new zhihu_account 生成新的sql文件</li>
<li>修改新sql文件，执行要更新数据表的操作</li>
<li>python migration.py check zhihu_account</li>
<li>git push，create merge request，发起评审</li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> 上线数据库该表功能</li>
</ul>
<p>###0815</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 新需求-fork-创建分支-merge主干<ul>
<li>fork </li>
<li>创建分支</li>
<li>merge主干（不是fork的主干，是真正的主干）</li>
<li>git remote -v</li>
<li>git remote add upstream git@git.in.zhihu.com:commercial/orgop.git</li>
<li>git pull upstream master</li>
<li><a href="http://www.jianshu.com/p/964de879904a" target="_blank" rel="noopener">合并多次commit</a></li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> 完成邮件服务迁移上线操作</li>
</ul>
<p>###0814</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 组织会议调研机构提问报表数据的高稳定性需求<ul>
<li>产品层面(短期内数据源无法稳定的前提)<ul>
<li>异常情况的及时同步，前端展现／交互更加友好</li>
</ul>
</li>
<li>技术层面<ul>
<li>定位数据源不稳定的根本原因</li>
<li>数据源为hue的字段调研用rpc的字段聚合而成</li>
<li>消息同步</li>
</ul>
</li>
</ul>
</li>
<li><p>[ ] 邮件服务迁移代码完成开发</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new_send_mail</span><span class="params">(subject, content, to)</span>:</span></span><br><span class="line">    params = &#123;</span><br><span class="line">        <span class="string">'topic'</span>: <span class="string">u'mail_txn'</span>,</span><br><span class="line">        <span class="string">'from'</span>: <span class="string">u'知乎 &lt;account@zhihu.com&gt;'</span>.encode(<span class="string">'utf-8'</span>),</span><br><span class="line">        <span class="string">'to'</span>: to,</span><br><span class="line">        <span class="string">'subject'</span>: subject,</span><br><span class="line">        <span class="string">'body'</span>: content,</span><br><span class="line">        <span class="string">'utm_campaign'</span>: <span class="string">u'email_request'</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    requests.post(<span class="string">"http://proxy-postbox_rpcsrv.tc.rack.zhihu.com:18574/deliver"</span>, data=params)</span><br></pre></td></tr></table></figure>
</li>
<li><p>[ ] 本周任务分工</p>
<ul>
<li>数据抓取自测</li>
<li>图片上传服务迁移</li>
<li>机构注册开放带来的数据分表</li>
<li>品牌提问rpc接口设计</li>
</ul>
</li>
</ul>
<p>##20170807-20170811</p>
<p>###0811</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 两天培训感受<ul>
<li>通过知乎平台与世界分享你的知识，经验，见解</li>
<li>沉淀高价值内容，广告也应该是有价值的内容</li>
<li>品牌广告 + 效果广告 + 机构推广 + 知乎指数</li>
<li>规模化营收／多元化的数据支撑／丰富消费场景<br>###0810</li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> 熟悉sql join on, left/right jion区别，使用sql语句查询需求指标，知晓各字段含义</li>
<li><p>[ ] 温习装饰模式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">log</span><span class="params">(func)</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(*args, **kwargs)</span>:</span></span><br><span class="line">		<span class="keyword">print</span> func.__name__ + <span class="string">'start'</span></span><br><span class="line">		func(*args, **kwargs)</span><br><span class="line">		<span class="keyword">print</span> func.__name__ + <span class="string">'end'</span></span><br><span class="line">	<span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"><span class="meta">@log</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(*args, **kwargs)</span>:</span></span><br><span class="line">	<span class="keyword">print</span> <span class="string">'hello world'</span></span><br><span class="line"></span><br><span class="line">foo()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">connect</span><span class="params">(host = <span class="string">'127.0.0.1'</span>, port = <span class="number">12301</span>)</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">decorator</span><span class="params">(func)</span>:</span></span><br><span class="line">		<span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">()</span>:</span></span><br><span class="line">			<span class="keyword">print</span> func.__name__ + host + <span class="string">' start'</span></span><br><span class="line">			func()</span><br><span class="line">			<span class="keyword">print</span> func.__name__ + str(port) + <span class="string">' end'</span> </span><br><span class="line">		<span class="keyword">return</span> wrapper</span><br><span class="line">	<span class="keyword">return</span> decorator</span><br><span class="line"></span><br><span class="line"><span class="meta">@connect()</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bar</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	<span class="title">print</span> '<span class="title">hello</span> <span class="title">world</span>'</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">bar</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p>[ ] 机构账号开放注册，数据报表面临数据量暴增的需求</p>
<ul>
<li>分表<br><img src="./[RFC] 品牌提问数据报表.jpg" alt="Alt text"></li>
</ul>
</li>
</ul>
<p>###0809</p>
<ul>
<li><p>[ ] 分布图</p>
<ul>
<li>浏览数<br><img src="./浏览数分布.png" alt="Alt text"></li>
<li>曝光量<br><img src="./曝光量分布.png" alt="Alt text"></li>
<li>关注数<br><img src="./关注数分布.png" alt="Alt text"></li>
<li>回答数<br><img src="./回答数分布.png" alt="Alt text"></li>
<li>评论数<br><img src="./评论数分布.png" alt="Alt text"></li>
<li>分享数<br><img src="./分享数分布.png" alt="Alt text"></li>
</ul>
</li>
<li><p>[ ] 测试bloom-filter功能和性能</p>
<ul>
<li>插入200W数据，查询200W数据</li>
<li>最大内存占用为17M，误报2条数据，误报率为0.00235%，时间运行201s</li>
</ul>
</li>
<li><p>[ ] 触达</p>
<ul>
<li>累计<ul>
<li>自然／广告曝光次数</li>
<li>自然／广告曝光人数</li>
<li>自然／广告曝光点击数</li>
<li>阅读次数</li>
<li>阅读人数</li>
</ul>
</li>
<li>新增<ul>
<li>自然／广告曝光次数</li>
<li>自然／广告曝光人数</li>
<li>自然／广告曝光点击数</li>
<li>阅读次数</li>
<li>阅读人数</li>
</ul>
</li>
</ul>
</li>
<li><p>[ ] 内容</p>
<ul>
<li>累计<ul>
<li>回答数</li>
<li>推荐回答数</li>
<li>回答均字</li>
</ul>
</li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> 互动<ul>
<li>累计<ul>
<li>回答数</li>
<li>关注数</li>
<li>赞同数</li>
<li>收藏数</li>
<li>评论数</li>
<li>分享数</li>
<li>感谢数</li>
<li>评论赞数</li>
</ul>
</li>
<li>新增<ul>
<li>回答数</li>
<li>关注数</li>
<li>赞同数</li>
<li>收藏数</li>
<li>评论数</li>
<li>分享数</li>
<li>感谢数</li>
<li>评论赞数</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>###0808<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">org-&gt;orgop:申请注册材料</span><br><span class="line">orgop-&gt;org:回复已收到申请</span><br><span class="line">Note right of orgop:申请通过</span><br><span class="line">orgop-&gt;org:邀请注册码</span><br><span class="line">org-&gt;zhihu_web:注册</span><br><span class="line">Note right of zhihu_web:创建机构账号</span><br><span class="line">zhihu_web-&gt;org:注册完成</span><br><span class="line">org-&gt;zhihu_web:首次登陆</span><br><span class="line">zhihu_web-&gt;org:提示上传审核材料</span><br><span class="line">org-&gt;zhihu_web:提交审核材料</span><br><span class="line">orgop-&gt;zhihu_web:获取待审核的机构及审核材料</span><br><span class="line">Note right of orgop:审核通过</span><br><span class="line">orgop-&gt;zhihu_web:更新数据库(orgop请求zhihu_web更新数据库)</span><br></pre></td></tr></table></figure></p>
<ul>
<li style="list-style: none"><input type="checkbox"> 温习db.py, orm.py等，搭建mysql本地环境，熟悉元类等模式</li>
<li style="list-style: none"><input type="checkbox"> 组织会议确认品牌提问报表需求的技术实现方案，落地到RFC，并确认分工</li>
</ul>
<p>###0807</p>
<ul>
<li><p>[ ] 机构提问报表</p>
<ul>
<li>新增数据与环比<br>| 日期    | 8.1      |     8.2 |   8.3   |  8.4   |<br>| :——–:| :——–: | :——–:| :——: |:——: |<br>| 曝光数 | 20    |   30 |  50  | 60  |<br>8月3号的新增数据环比 = （（50 - 30）- （30 - 20））／（30 - 20）</li>
<li>曝光数(cardshow)<ul>
<li>自然曝光<ul>
<li>关注用户</li>
<li>非关注用户（二度流通，来自关注者的关注，评论，赞同等）</li>
</ul>
</li>
<li>广告曝光</li>
</ul>
</li>
<li>阅读(pageshow)</li>
<li>赞同数</li>
<li>感谢数</li>
<li>评论数</li>
<li>收藏数</li>
<li>分享数</li>
</ul>
</li>
<li><p>[ ] <a href="http://wiki.in.zhihu.com/pages/viewpage.action?pageId=16319815" target="_blank" rel="noopener">品牌提问数据报表</a><br><img src="./广告运营平台-品牌提问数据-2.png" alt="Alt text"></p>
</li>
</ul>
<p>##20170731-20170804</p>
<p>###0804</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 申请za权限(done)</li>
<li><p>[ ] 构思品牌提问功能架构</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">script-&gt;redis&amp;mysql:基础数据</span><br><span class="line">Note right of script:访问rpc&amp;hue，获取基础数据，存入redis</span><br><span class="line">api-&gt;redis&amp;mysql:前端请求转换，并缓存应答</span><br><span class="line">前端-&gt;api:Req</span><br></pre></td></tr></table></figure>
</li>
<li><p>redis层</p>
<ul>
<li>数据粒度</li>
<li>数据大小</li>
<li>redis集群的运维，监控等</li>
</ul>
</li>
<li>api层<ul>
<li>前端请求协议转化(配置)</li>
<li>缓存机制(实时性需求)</li>
</ul>
</li>
</ul>
<p>###0803</p>
<ul>
<li><p>[ ] cfbclient <em>配置宝客户端，读取线上配置</em><br><a href="wiki.corpautohome.com/pages/viewpage.action?pageId=34146859">使用示例</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> cfbclient <span class="keyword">import</span> connect</span><br><span class="line">config = connect(<span class="string">'zhihu-api'</span>)</span><br><span class="line"><span class="keyword">print</span> config[<span class="string">'sentry_dsn'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 支持本地配置</span></span><br><span class="line">export CFB_LOCAL=tests/cfb.json</span><br></pre></td></tr></table></figure>
</li>
<li><p>[ ]  diplomat <em>服务发现</em></p>
<ul>
<li>服务注册</li>
<li>服务发现</li>
<li>负载策略<ul>
<li>random <em>默认</em></li>
<li>roundrobin</li>
</ul>
</li>
<li>两级缓存 <em>内存30s  磁盘1天</em></li>
<li>服务覆盖</li>
</ul>
</li>
</ul>
<p><a href="http://diplomat.zhdocs.io/readme.html#how-it-works" target="_blank" rel="noopener">使用示例</a><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> diplomat <span class="keyword">import</span> discover</span><br><span class="line">diplomat = discover()</span><br><span class="line"></span><br><span class="line"><span class="comment">#服务发现</span></span><br><span class="line">diplomat.find(<span class="string">'redis'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#服务注册</span></span><br><span class="line">diplomat.agent.service.register(<span class="string">'redis'</span>,</span><br><span class="line">                     port=<span class="number">6379</span>,</span><br><span class="line">                     tags=[<span class="string">'master'</span>, <span class="string">'release'</span>],</span><br><span class="line">                     ttl=<span class="string">'10s'</span>)</span><br></pre></td></tr></table></figure></p>
<ul>
<li style="list-style: none"><input type="checkbox"> pstatsd <em>状态收集API</em><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pstatsd <span class="keyword">import</span> Statsd</span><br><span class="line">Statsd.initialize(app_name=<span class="string">"zhihu_web"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#计数</span></span><br><span class="line">Statsd.incr(<span class="string">"web-500"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#计时</span></span><br><span class="line"><span class="meta">@Statsd.time("cost_of_f")</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#记录单一时间点的状态。如线程数，堆使用量，当前温度等</span></span><br><span class="line">Statsd.gauge(<span class="string">"queue_size"</span>, queue_size)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>###0802</p>
<ul>
<li><p>[ ] paxos算法</p>
<ul>
<li>Proposer提案，提案id保证自增，分两阶段提案<ul>
<li>phase1 <em>准备阶段</em> <strong>对应的acceptor返回当前的提案id，以及value</strong></li>
<li>phase2 <em>投票阶段</em></li>
</ul>
</li>
<li>Acceptor<ul>
<li>只接受提案id比之前收到的提案id大的提案</li>
<li>对于第一次收到的提案无条件赞成</li>
</ul>
</li>
<li>Learner</li>
<li><a href="http://www.solinx.co/archives/403" target="_blank" rel="noopener">案例</a></li>
</ul>
</li>
<li><p>[ ] 机构账号产品了解</p>
<ul>
<li>机构帐号帐号体系<ul>
<li>机构账号的需求是全局的<ul>
<li>自身需求：发表提问，文章</li>
<li>全局需求：浏览社区话题，问题，回答，专栏文章等</li>
<li>机构对公众对象的标记和再生产：关注行业话题、竞品、key opinion leader后能形成自己的关注动态TOP STORY</li>
</ul>
</li>
<li>facebook的page产品形态采用的是普通用户使用机构功能去发表文章，更新主页状态等自身需求，但需要切换成机构账号才能去实现全局需求</li>
<li>知乎产品的特点是多站之间交互性强，两套用户体系带来较差的体验</li>
</ul>
</li>
<li>邀请注册</li>
<li>注册审核</li>
<li>后台管理<ul>
<li>审核管理</li>
<li>注册管理</li>
<li>机构账号管理</li>
<li>数据</li>
<li>操作记录</li>
<li>模版管理</li>
<li>权限管理</li>
</ul>
</li>
<li>机构登陆<ul>
<li>与个人登陆页面一致，支持密码重置</li>
</ul>
</li>
<li>机构回答<ul>
<li>不能匿名，其他和普通用户基本一致</li>
</ul>
</li>
<li>机构文章<ul>
<li>文章数量限制</li>
<li>评论样式</li>
<li>定期发布</li>
<li>支持活动，投票等</li>
</ul>
</li>
<li>机构评论管理<ul>
<li>开放评论</li>
<li>预审评论</li>
<li>关闭评论</li>
</ul>
</li>
<li>机构认证标识</li>
<li>机构盐值<ul>
<li>评估标准<ul>
<li>质量度 <strong>45%</strong><ul>
<li>点赞，收藏，反对等</li>
</ul>
</li>
<li>创造力 <strong>25%</strong><ul>
<li>发帖数和均字数</li>
</ul>
</li>
<li>活跃度 <strong>10%</strong><ul>
<li>日动态</li>
</ul>
</li>
<li>信用值</li>
<li>影响力 <strong>20%</strong><ul>
<li>关注数</li>
</ul>
</li>
</ul>
</li>
<li>评估周期：一周<br>###0801</li>
</ul>
</li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> buildout orgop，zhihuaccount成功，理清版本依赖关系，重新安装python替代mac自带python</li>
<li style="list-style: none"><input type="checkbox"> <a href="http://ph.in.zhihu.com/T40507" target="_blank" rel="noopener">机构账号体系产品迭代讨论</a></li>
<li style="list-style: none"><input type="checkbox"> 单步跟踪orgop代码<ul>
<li>config,logging初始化等</li>
<li>tracing<ul>
<li>cfbclient</li>
<li>kafkaclient</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>###0731</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 静下心来每天有所收获，有所进步，若没有进步反思为什么？</li>
<li style="list-style: none"><input type="checkbox"> 周末啥事没干<br><img src="./机构账号Q3规划.png" alt="Alt text"></li>
</ul>
<p>##20170726-20170728</p>
<p>###0726</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 入职知乎，熟悉mac使用，熟悉公司环境和开发环境<ul>
<li>新人引导</li>
<li>checkout代码，新建分支，更改Readme，并提交</li>
<li>搭建开发环境，申请跳板机权限</li>
</ul>
</li>
</ul>
<p>###0727</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 熟悉python开发规范</li>
<li style="list-style: none"><input type="checkbox"> 熟悉机构账号产品形态<ul>
<li>社区提问：基于提问实现内容的分发与管理，有一定的公共属性</li>
<li>机构提问：私有需求<ul>
<li>调研征集&amp;组织讨论&amp;流量曝光</li>
<li>隐藏消极回答，<em>对机构有正向效果，但对用户不够客观</em></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>###0728</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 熟悉jekins，platfrom，halo，监控平台等开发环境</li>
<li style="list-style: none"><input type="checkbox"> 熟悉buildout机制</li>
</ul>
<p>##201707010-20170714</p>
<p>###0710</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 熟悉agent模块架构以及运行机制<ul>
<li>定位10.168.66.187上agent运行失败的原因，已定位到，加载qconf_py库失败</li>
<li>定位10.168.66.193上agent运行失败的原因，/home/w/kvcluster3plus目录下没有某业务线，<strong>python必须是2.6.6版本，支持from kazoo.client import KazooClient</strong></li>
<li>web.py需要python2.7<br>##20170703-20170707<br>###0705</li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> 联盟对接进一步抽象，通用<ul>
<li>明确联盟优先级和随机需求 </li>
<li>生成联盟请求列表，广告位id + 联盟id为key，按照联盟优先级排序<br>###0704</li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> ifdown bond0 关闭网卡，<strong>线上机器不要乱操作</strong></li>
<li style="list-style: none"><input type="checkbox"> DspCacheAttrbute业务redis集群被告知超时，查看各项指标正常，让通知者检查机器间延迟，因为偶尔的超时，没有效果，没有让通知者检查机器的流量（后被证实业务端服务所部署的机器流量过高导致）</li>
<li style="list-style: none"><input type="checkbox"> 联盟对接进一步抽象，通用<br>###0703</li>
<li style="list-style: none"><input type="checkbox"> 10.60 dspindex进程占用内存较大</li>
<li>从/proc/pid/fd文件看是5月8号建立的连接（应该是那天启动的）</li>
<li>从内存监控图看3月8号当天没有波动</li>
<li>从/proc/pid/smaps文件看应该是线程启动后申请的空间<br><a href="http://blog.csdn.net/lijzheng/article/details/23618365" target="_blank" rel="noopener">linux proc maps文件分析</a><br><a href="http://wangxuemin.github.io/2015/07/30/LINUX%E7%A8%8B%E5%BA%8F%28%E8%BF%9B%E7%A8%8B%29%E5%9C%A8%E5%86%85%E5%AD%98%E4%B8%AD%E7%9A%84%E5%B8%83%E5%B1%80/" target="_blank" rel="noopener">LINUX程序(进程)在内存中的布局</a><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">7f</span>0f49000000<span class="number">-7f</span>1c4f400000 rw-p <span class="number">00000000</span> <span class="number">00</span>:<span class="number">00</span> <span class="number">0</span>	<span class="comment">//匿名mapping，rw-p可读写，数据段；r-xp可读+执行，代码段</span></span><br><span class="line">Size:           <span class="number">54628352</span> kB			虚拟内存</span><br><span class="line">Rss:            <span class="number">44691664</span> kB			常驻物理内存</span><br><span class="line">Pss:            <span class="number">44691664</span> kB			常驻物理内存中私有部分</span><br><span class="line">Shared_Clean:          <span class="number">0</span> kB</span><br><span class="line">Shared_Dirty:          <span class="number">0</span> kB</span><br><span class="line">Private_Clean:         <span class="number">0</span> kB</span><br><span class="line">Private_Dirty:  <span class="number">44691664</span> kB</span><br><span class="line">Referenced:     <span class="number">41993812</span> kB</span><br><span class="line">Anonymous:      <span class="number">44691664</span> kB</span><br><span class="line">AnonHugePages:  <span class="number">42313728</span> kB</span><br><span class="line">Swap:            <span class="number">8250700</span> kB</span><br><span class="line">KernelPageSize:        <span class="number">4</span> kB</span><br><span class="line">MMUPageSize:           <span class="number">4</span> kB</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;pthread.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> s;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> s2;</span><br><span class="line"><span class="keyword">int</span> d = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> d1;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span>* <span class="title">run</span><span class="params">(<span class="keyword">void</span>* data)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span>* ps = (<span class="keyword">char</span>*)<span class="built_in">malloc</span>(<span class="number">8</span>);</span><br><span class="line">    <span class="keyword">char</span>* ps2 = (<span class="keyword">char</span>*)<span class="built_in">malloc</span>(<span class="number">8</span>);</span><br><span class="line">    <span class="keyword">char</span>* ps3 = (<span class="keyword">char</span>*)<span class="built_in">malloc</span>(<span class="number">1024</span> * <span class="number">1024</span>);</span><br><span class="line">    <span class="keyword">char</span>* ps4 = (<span class="keyword">char</span>*)<span class="built_in">malloc</span>(<span class="number">1024</span> * <span class="number">1024</span>);</span><br><span class="line">    <span class="keyword">char</span> pc[<span class="number">1024</span>];</span><br><span class="line">    <span class="keyword">int</span> pa = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"threadps=%p\n"</span>, ps);<span class="comment">//0x7f99500008c0</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"threadps2=%p\n"</span>, ps2);<span class="comment">//0x7f99500008e0</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"threadps3=%p\n"</span>, ps3);<span class="comment">//0x7f995737a010</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"threadps4=%p\n"</span>, ps4);<span class="comment">//0x7f9957279010</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"threadpc=%p\n"</span>, &amp;pc);<span class="comment">//0x7f9957e7aa60</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"threadpa=%p\n"</span>, &amp;pa);<span class="comment">//0x7f9957e7ae6c</span></span><br><span class="line">    pause();</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>* argv[])</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> c[<span class="number">100</span>];</span><br><span class="line">    <span class="keyword">char</span> c2[<span class="number">100</span>];</span><br><span class="line">    <span class="keyword">char</span>* p0 = (<span class="keyword">char</span>*)<span class="built_in">malloc</span>(<span class="number">8</span>);</span><br><span class="line">    <span class="keyword">char</span>* p1 = (<span class="keyword">char</span>*)<span class="built_in">malloc</span>(<span class="number">1024</span> * <span class="number">1024</span>);</span><br><span class="line">    <span class="keyword">char</span>* p2 = (<span class="keyword">char</span>*)<span class="built_in">malloc</span>(<span class="number">1024</span> * <span class="number">1024</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/*main,printf在代码区*/</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"main=%p\n"</span>, main);<span class="comment">//0x400798</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"printf=%p\n"</span>, <span class="built_in">printf</span>);<span class="comment">//0x400568</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">/*全局数据不管有没有初始化都在data区*/</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"static s=%p\n"</span>, &amp;s);<span class="comment">//0x600df8 static，</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"static s2=%p\n"</span>, &amp;s2);<span class="comment">//0x600dfc</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"global-data d=%p\n"</span>, &amp;d);<span class="comment">//0x600df0</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"global-data d1=%p\n"</span>, &amp;d1);<span class="comment">//0x600df4</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">/*主线程的局部变量在stack区*/</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"stack c=%p\n"</span>, c);<span class="comment">//0x7fff061e19b0</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"stack c2=%p\n"</span>, c2);<span class="comment">//0x7fff061e1940</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">/*主线程申请128字节以下的变量在heap区*/</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"p0=%p\n"</span>, p0);<span class="comment">//0x1945010</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">/*主线程申请128字节以上的变量在Memory Mapping Segment区*/</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"p1=%p\n"</span>, p1);<span class="comment">//0x7f9957f7d010</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"p2=%p\n"</span>, p2);<span class="comment">//0x7f9957e7c010</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">pthread_t</span> id;</span><br><span class="line">    <span class="comment">/*创建线程时在maps文件中就增加了两条记录，分别是子线程的栈空间和栈保护页的记录。默认情况下，pthread为子线程预留的栈空间大小为1MB，栈保护页为4KB（这主要跟页大小相关）*/</span></span><br><span class="line">    pthread_create(&amp;id, <span class="literal">NULL</span>, &amp;run, <span class="literal">NULL</span>);</span><br><span class="line">    pause();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//----------------------------maps</span></span><br><span class="line"><span class="number">00400000</span><span class="number">-00401000</span> r-xp <span class="number">00000000</span> fd:<span class="number">00</span> <span class="number">3942581</span>                            /home/zhoufan/test/c/mem</span><br><span class="line"><span class="number">00600000</span><span class="number">-00601000</span> rw-p <span class="number">00000000</span> fd:<span class="number">00</span> <span class="number">3942581</span>                            /home/zhoufan/test/c/mem</span><br><span class="line"><span class="number">01945000</span><span class="number">-01966000</span> rw-p <span class="number">00000000</span> <span class="number">00</span>:<span class="number">00</span> <span class="number">0</span>                                  [heap]</span><br><span class="line"><span class="number">3363</span>a00000<span class="number">-3363</span>a20000 r-xp <span class="number">00000000</span> fd:<span class="number">00</span> <span class="number">1048604</span>                        /lib64/ld<span class="number">-2.12</span>.so</span><br><span class="line"><span class="number">3363</span>c1f000<span class="number">-3363</span>c20000 r--p <span class="number">0001f</span>000 fd:<span class="number">00</span> <span class="number">1048604</span>                        /lib64/ld<span class="number">-2.12</span>.so</span><br><span class="line"><span class="number">3363</span>c20000<span class="number">-3363</span>c21000 rw-p <span class="number">00020000</span> fd:<span class="number">00</span> <span class="number">1048604</span>                        /lib64/ld<span class="number">-2.12</span>.so</span><br><span class="line"><span class="number">3363</span>c21000<span class="number">-3363</span>c22000 rw-p <span class="number">00000000</span> <span class="number">00</span>:<span class="number">00</span> <span class="number">0</span> </span><br><span class="line"><span class="number">3363e00000</span><span class="number">-3363f</span>8a000 r-xp <span class="number">00000000</span> fd:<span class="number">00</span> <span class="number">1048637</span>                        /lib64/libc<span class="number">-2.12</span>.so</span><br><span class="line"><span class="number">3363f</span>8a000<span class="number">-336418</span>a000 ---p <span class="number">0018</span>a000 fd:<span class="number">00</span> <span class="number">1048637</span>                        /lib64/libc<span class="number">-2.12</span>.so</span><br><span class="line"><span class="number">336418</span>a000<span class="number">-336418e000</span> r--p <span class="number">0018</span>a000 fd:<span class="number">00</span> <span class="number">1048637</span>                        /lib64/libc<span class="number">-2.12</span>.so</span><br><span class="line"><span class="number">336418e000</span><span class="number">-336418f</span>000 rw-p <span class="number">0018e000</span> fd:<span class="number">00</span> <span class="number">1048637</span>                        /lib64/libc<span class="number">-2.12</span>.so</span><br><span class="line"><span class="number">336418f</span>000<span class="number">-3364194000</span> rw-p <span class="number">00000000</span> <span class="number">00</span>:<span class="number">00</span> <span class="number">0</span> </span><br><span class="line"><span class="number">3364600000</span><span class="number">-3364617000</span> r-xp <span class="number">00000000</span> fd:<span class="number">00</span> <span class="number">1048640</span>                        /lib64/libpthread<span class="number">-2.12</span>.so</span><br><span class="line"><span class="number">3364617000</span><span class="number">-3364817000</span> ---p <span class="number">00017000</span> fd:<span class="number">00</span> <span class="number">1048640</span>                        /lib64/libpthread<span class="number">-2.12</span>.so</span><br><span class="line"><span class="number">3364817000</span><span class="number">-3364818000</span> r--p <span class="number">00017000</span> fd:<span class="number">00</span> <span class="number">1048640</span>                        /lib64/libpthread<span class="number">-2.12</span>.so</span><br><span class="line"><span class="number">3364818000</span><span class="number">-3364819000</span> rw-p <span class="number">00018000</span> fd:<span class="number">00</span> <span class="number">1048640</span>                        /lib64/libpthread<span class="number">-2.12</span>.so</span><br><span class="line"><span class="number">3364819000</span><span class="number">-336481</span>d000 rw-p <span class="number">00000000</span> <span class="number">00</span>:<span class="number">00</span> <span class="number">0</span> </span><br><span class="line"><span class="number">3364e00000</span><span class="number">-3364e83000</span> r-xp <span class="number">00000000</span> fd:<span class="number">00</span> <span class="number">1048647</span>                        /lib64/libm<span class="number">-2.12</span>.so</span><br><span class="line"><span class="number">3364e83000</span><span class="number">-3365082000</span> ---p <span class="number">00083000</span> fd:<span class="number">00</span> <span class="number">1048647</span>                        /lib64/libm<span class="number">-2.12</span>.so</span><br><span class="line"><span class="number">3365082000</span><span class="number">-3365083000</span> r--p <span class="number">00082000</span> fd:<span class="number">00</span> <span class="number">1048647</span>                        /lib64/libm<span class="number">-2.12</span>.so</span><br><span class="line"><span class="number">3365083000</span><span class="number">-3365084000</span> rw-p <span class="number">00083000</span> fd:<span class="number">00</span> <span class="number">1048647</span>                        /lib64/libm<span class="number">-2.12</span>.so</span><br><span class="line"><span class="number">3454</span>a00000<span class="number">-3454</span>a16000 r-xp <span class="number">00000000</span> fd:<span class="number">00</span> <span class="number">1048582</span>                        /lib64/libgcc_s<span class="number">-4.4</span><span class="number">.7</span><span class="number">-20120601.</span>so<span class="number">.1</span></span><br><span class="line"><span class="number">3454</span>a16000<span class="number">-3454</span>c15000 ---p <span class="number">00016000</span> fd:<span class="number">00</span> <span class="number">1048582</span>                        /lib64/libgcc_s<span class="number">-4.4</span><span class="number">.7</span><span class="number">-20120601.</span>so<span class="number">.1</span></span><br><span class="line"><span class="number">3454</span>c15000<span class="number">-3454</span>c16000 rw-p <span class="number">00015000</span> fd:<span class="number">00</span> <span class="number">1048582</span>                        /lib64/libgcc_s<span class="number">-4.4</span><span class="number">.7</span><span class="number">-20120601.</span>so<span class="number">.1</span></span><br><span class="line"><span class="number">3454e00000</span><span class="number">-3454</span>ee8000 r-xp <span class="number">00000000</span> fd:<span class="number">00</span> <span class="number">8936196</span>                        /usr/lib64/libstdc++.so<span class="number">.6</span><span class="number">.0</span><span class="number">.13</span></span><br><span class="line"><span class="number">3454</span>ee8000<span class="number">-34550e8000</span> ---p <span class="number">000e8000</span> fd:<span class="number">00</span> <span class="number">8936196</span>                        /usr/lib64/libstdc++.so<span class="number">.6</span><span class="number">.0</span><span class="number">.13</span></span><br><span class="line"><span class="number">34550e8000</span><span class="number">-34550</span>ef000 r--p <span class="number">000e8000</span> fd:<span class="number">00</span> <span class="number">8936196</span>                        /usr/lib64/libstdc++.so<span class="number">.6</span><span class="number">.0</span><span class="number">.13</span></span><br><span class="line"><span class="number">34550</span>ef000<span class="number">-34550f</span>1000 rw-p <span class="number">000</span>ef000 fd:<span class="number">00</span> <span class="number">8936196</span>                        /usr/lib64/libstdc++.so<span class="number">.6</span><span class="number">.0</span><span class="number">.13</span></span><br><span class="line"><span class="number">34550f</span>1000<span class="number">-3455106000</span> rw-p <span class="number">00000000</span> <span class="number">00</span>:<span class="number">00</span> <span class="number">0</span> </span><br><span class="line"><span class="number">7f</span>9950000000<span class="number">-7f</span>9950021000 rw-p <span class="number">00000000</span> <span class="number">00</span>:<span class="number">00</span> <span class="number">0</span> </span><br><span class="line"><span class="number">7f</span>9950021000<span class="number">-7f</span>9954000000 ---p <span class="number">00000000</span> <span class="number">00</span>:<span class="number">00</span> <span class="number">0</span> </span><br><span class="line"><span class="number">7f</span>9957279000<span class="number">-7f</span>995747b000 rw-p <span class="number">00000000</span> <span class="number">00</span>:<span class="number">00</span> <span class="number">0</span> </span><br><span class="line"><span class="number">7f</span>995747b000<span class="number">-7f</span>995747c000 ---p <span class="number">00000000</span> <span class="number">00</span>:<span class="number">00</span> <span class="number">0</span> </span><br><span class="line"><span class="number">7f</span>995747c000<span class="number">-7f</span>9958083000 rw-p <span class="number">00000000</span> <span class="number">00</span>:<span class="number">00</span> <span class="number">0</span> </span><br><span class="line"><span class="number">7f</span>9958097000<span class="number">-7f</span>9958099000 rw-p <span class="number">00000000</span> <span class="number">00</span>:<span class="number">00</span> <span class="number">0</span> </span><br><span class="line"><span class="number">7f</span>ff061ce000<span class="number">-7f</span>ff061e3000 rw-p <span class="number">00000000</span> <span class="number">00</span>:<span class="number">00</span> <span class="number">0</span>                          [<span class="built_in">stack</span>]</span><br><span class="line"><span class="number">7f</span>ff061ff000<span class="number">-7f</span>ff06200000 r-xp <span class="number">00000000</span> <span class="number">00</span>:<span class="number">00</span> <span class="number">0</span>                          [vdso]</span><br><span class="line">ffffffffff600000-ffffffffff601000 r-xp <span class="number">00000000</span> <span class="number">00</span>:<span class="number">00</span> <span class="number">0</span>                  [vsyscall]</span><br></pre></td></tr></table></figure>
<ul>
<li style="list-style: none"><input type="checkbox"> 10.59 adx超时问题<ul>
<li>一开始从网络IO去定位，通过比对多台机器的监控图，发现IO有毛刺，但是不能就此推出超时原因<br><img src="./粘贴图片.png" alt="Alt text"></li>
<li>后面发现系统负载较高，查看网络IO，磁盘IO，发现磁盘IO负载较高，发现磁盘有问题</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Device:      rrqm/s   wrqm/s     r/s     w/s   rsec/s   wsec/s avgrq-sz avgqu-sz   <span class="keyword">await</span>  svctm  %util</span><br><span class="line">sda           <span class="number">0.00</span>     <span class="number">0.00</span>  <span class="number">549.00</span>  <span class="number">156.00</span> <span class="number">77024.00</span> <span class="number">36984.00</span>   <span class="number">161.71</span>   <span class="number">147.15</span>  <span class="number">622.57</span>   <span class="number">1.42</span> <span class="number">100.00</span></span><br><span class="line"></span><br><span class="line">avg-cpu:  %user   %nice %system %iowait  %steal   %idle</span><br><span class="line">           <span class="number">4.21</span>    <span class="number">0.00</span>    <span class="number">1.81</span>    <span class="number">9.55</span>    <span class="number">0.00</span>   <span class="number">84.42</span></span><br><span class="line"></span><br><span class="line">Device:     rrqm/s   wrqm/s     r/s     w/s   rsec/s   wsec/s avgrq-sz avgqu-sz   <span class="keyword">await</span>  svctm  %util</span><br><span class="line">sda           <span class="number">0.00</span>    <span class="number">37.00</span>  <span class="number">469.00</span>   <span class="number">64.00</span> <span class="number">110648.00</span> <span class="number">16016.00</span>   <span class="number">237.64</span>   <span class="number">150.68</span>  <span class="number">166.41</span>   <span class="number">1.88</span> <span class="number">100.00</span></span><br><span class="line"></span><br><span class="line">avg-cpu:  %user   %nice %system %iowait  %steal   %idle</span><br><span class="line">           <span class="number">4.85</span>    <span class="number">0.00</span>    <span class="number">2.03</span>    <span class="number">8.87</span>    <span class="number">0.00</span>   <span class="number">84.26</span></span><br><span class="line"></span><br><span class="line">Device:     rrqm/s   wrqm/s     r/s     w/s   rsec/s   wsec/s avgrq-sz avgqu-sz   <span class="keyword">await</span>  svctm  %util</span><br><span class="line">sda           <span class="number">0.00</span>     <span class="number">2.00</span>  <span class="number">469.00</span>   <span class="number">39.00</span> <span class="number">116456.00</span>  <span class="number">9152.00</span>   <span class="number">247.26</span>   <span class="number">146.28</span>  <span class="number">141.49</span>   <span class="number">1.97</span> <span class="number">100.10</span></span><br></pre></td></tr></table></figure>
<p>##20170626-27170630</p>
<p>###0630</p>
<ul>
<li style="list-style: none"><input type="checkbox"> python exception<br>BaseException<br>+– SystemExit<br>+– KeyboardInterrupt<br>+– GeneratorExit<br>+– Exception<pre><code>+-- StopIteration
+-- StandardError
|    +-- BufferError
|    +-- ArithmeticError
|    |    +-- FloatingPointError
|    |    +-- OverflowError
|    |    +-- ZeroDivisionError
|    +-- AssertionError
|    +-- AttributeError
|    +-- EnvironmentError
|    |    +-- IOError
|    |    +-- OSError
|    |         +-- WindowsError (Windows)
|    |         +-- VMSError (VMS)
|    +-- EOFError
|    +-- ImportError
|    +-- LookupError
|    |    +-- IndexError
|    |    +-- KeyError
|    +-- MemoryError
|    +-- NameError
|    |    +-- UnboundLocalError
|    +-- ReferenceError
|    +-- RuntimeError
|    |    +-- NotImplementedError
|    +-- SyntaxError
|    |    +-- IndentationError
|    |         +-- TabError
|    +-- SystemError
|    +-- TypeError
|    +-- ValueError
|         +-- UnicodeError
|              +-- UnicodeDecodeError
|              +-- UnicodeEncodeError
|              +-- UnicodeTranslateError
+-- Warning
     +-- DeprecationWarning
     +-- PendingDeprecationWarning
     +-- RuntimeWarning
     +-- SyntaxWarning
     +-- UserWarning
     +-- FutureWarning
 +-- ImportWarning
 +-- UnicodeWarning
 +-- BytesWarning
</code></pre>###0629</li>
<li style="list-style: none"><input type="checkbox"> autoredis关闭redis提示”port is occupied”的原因是找不到/home/w/kvcluster3plus/UserInfo/redis/redis.pid文件<br>解决办法：ls |grep “5186[2-7]”|while read s; do netstat  -anp|grep $s | grep LISTEN|awk ‘{print $7}’|awk -F’/‘ ‘{print $1}’ &gt; $s/redis.pid;done </li>
<li style="list-style: none"><input type="checkbox"> redis设置keepalive属性<ul>
<li>CONFIG GET tcp-keepalive</li>
<li>CONFIG SET tcp-keepalive 60</li>
<li>利用防火墙关闭端口收发<ul>
<li>iptables -A INPUT -p tcp –dport 39975 -j DROP <strong>发过来的包，目标端口为39975，丢弃处理</strong></li>
<li>iptables -A OUTPUT -p tcp –dport 12301 -j DROP <strong>发出去的包，目标端口为12301，丢弃处理</strong></li>
</ul>
</li>
<li>利用redis-cli连接redis-server后，记住端口，配置防火墙，然后关闭redis-cli，该连接经过60s（可配置）后自动断开</li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> 三次握手&amp;四次握手<br><img src="./IMG_20170629_173853_HDR_[B@dec0496.jpg" alt="Alt text"></li>
</ul>
<p>###0628</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 完成orm.py，models.py的开发和测试，准备web.py</li>
<li style="list-style: none"><input type="checkbox"> 推动60_autoredis.py的升级部署，增加showlog和fork延迟的监控<br>###0627</li>
<li style="list-style: none"><input type="checkbox"> UserFeature业务的redis集群再次扩容，由47个节点扩容到59个，单节点内存减少至6.5G，在迁移的过程中出现不少慢操作，需要升级监控，已联系运维人员处理</li>
<li style="list-style: none"><input type="checkbox"> 准备orm.py开发<ul>
<li>Field 字段类，基类，mysql表的字段属性有字段名/是否主key/默认值/ddl/可为空/可更新/字段序号</li>
<li>Field字段类的子类有string，int，float，boolen等，默认值，ddl不同</li>
<li>Model表基类</li>
<li>ModelMetaclass元基类，负责生成各种数据库表类的类</li>
<li>User，Blog，Comment类继承Model基类，定义各字段<br>###0626</li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> 搭建bow开发环境，完成db.py的50%开发量</li>
<li style="list-style: none"><input type="checkbox"> 代码结构<ul>
<li>Engine设置db访问属性数据user, password, db等，全局变量</li>
<li>LasyConnection调用engine.connect获取连接句柄</li>
<li>_DbCtx 线程变量，调用LasyConnection获取连接句柄</li>
<li>_TransactionCtx</li>
<li>_ConnectionCtx</li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> 熟悉语法特性<ul>
<li><strong>enter</strong> &amp; <strong>exit</strong> <strong>配合with使用</strong></li>
<li><strong>getattr</strong> &amp; <strong>setattr</strong></li>
<li>super(classname, self).<strong>init</strong>()</li>
<li>@functools.wraps(func) <strong>保留func.<strong>name</strong></strong></li>
<li>cols, args = zip(<em>kw.iteritems()) <em>*cols=所有的key，args=所有的value</em></em></li>
<li>import doctest; doctest.testmod() 单测，测试每个函数中的注释部分<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update</span><span class="params">(sql, *args)</span>:</span></span><br><span class="line">    <span class="string">r'''</span></span><br><span class="line"><span class="string">    Execute update SQL.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; u1 = dict(id=1000, name='Michael', email='michael@test.org', passwd='123456', last_modified=time.time())</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; insert('user', **u1)</span></span><br><span class="line"><span class="string">    1</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; u2 = select_one('select * from user where id=?', 1000)</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; u2.email</span></span><br><span class="line"><span class="string">    u'michael@test.org'</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; u2.passwd</span></span><br><span class="line"><span class="string">    u'123456'</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; update('update user set email=?, passwd=? where id=?', 'michael@example.org', '654321', 1000)</span></span><br><span class="line"><span class="string">    1</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; u3 = select_one('select * from user where id=?', 1000)</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; u3.email</span></span><br><span class="line"><span class="string">    u'michael@example.org'</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; u3.passwd</span></span><br><span class="line"><span class="string">    u'654321'</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; update('update user set passwd=? where id=?', '***', '123\' or id=\'456')</span></span><br><span class="line"><span class="string">    0</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="keyword">return</span> _update(sql, *args)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p>##20170619-20170623</p>
<p>###0622</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 已运行前台进程转后台</li>
</ul>
<ol>
<li>Ctrl+Z挂起</li>
<li>jobs -l 查看任务号</li>
<li>bg %任务号 转后台运行</li>
<li>disown -h %任务号 将父进程置为1，省得端口网络或者关闭窗口时会SIGHUP信号，导致进程挂掉，类似于nohup + setsid<br>###0621</li>
</ol>
<ul>
<li style="list-style: none"><input type="checkbox"> 线上UserFeature集群内存超过90%，执行扩容<ul>
<li>线上执行redis-trib.rb失败原因：<br><a href="http://blog.csdn.net/c77_cn/article/details/38227797" target="_blank" rel="noopener">gem install redis</a></li>
<li>./redis-trib.rb rebalance –threshold 348 –use-empty-masters 192.168.5.24:51961<br>从30个实例增加到47个实例，16384/47=348，所以超过348 slot的节点都需要迁移， use-empty-masters利用没有slot的master节点</li>
<li>./redis-trib.rb fix 192.168.5.24:51961<br>迁移中出现问题时需要fix修复</li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> 增加UserAttribute redis监控，包括CPU/MEM/连接数/慢操作/FORK延迟/<br>###0620</li>
<li style="list-style: none"><input type="checkbox"> 192.168.7.48机器redis连接数打满，初步判定是客户端连接过多导致的，已修改maxclients为10000，重启服务后正常</li>
<li style="list-style: none"><input type="checkbox"> 增加UserAttribute redis集群监控</li>
<li style="list-style: none"><input type="checkbox"> 配合用户定向怕排查问题，热门key命中率22.4%左右<br>###0619</li>
<li style="list-style: none"><input type="checkbox"> 温习python，go部分语法，用go实现广度遍历</li>
<li style="list-style: none"><input type="checkbox"> 排查3038广告位一直没有出107客户的广告</li>
</ul>
<p>##20170612-20170616</p>
<p>###0615</p>
<ul>
<li style="list-style: none"><input type="checkbox"> redis字段</li>
<li>redis性能下降<ul>
<li>used_memory(redis内存分配器分配的内存大小) &gt; used_memory_rss(系统内核分配给redis进程的物理内存大小)，使用swap内存，若used_memory_rss/used_memory &gt;&gt; 1，存在过多内存碎片；<strong>可监控</strong></li>
<li>CPU负载较高 <em>**</em></li>
<li>IO负载高 <strong>可监控 instantaneous_input_kbps/instantaneous_output_kbps</strong></li>
<li>慢操作较多 <strong>可监控</strong></li>
<li>fork出现阻塞 <strong>可监控 latest_fork_usec</strong></li>
<li>大范围key出现同时过期 <strong>可监控 expired_keys/evicted_keys</strong></li>
<li>aof fsync阻塞 <strong>aof_pending_bio_fsync</strong></li>
</ul>
</li>
<li>redis内存占用上升<ul>
<li>key的value值较长</li>
<li>进出口缓冲区占用大量空间 <strong>可监控 client_longest_output_list/client_biggest_input_buf</strong></li>
<li>fork COW <strong>可监控 latest_fork_usec</strong></li>
</ul>
</li>
<li>redis 扩/缩容<ul>
<li>qps降低 <strong>instantaneous_ops_per_sec</strong></li>
<li>key hit降低 <strong>keyspace_hits/keyspace_misses</strong></li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> redis监控</li>
<li>服务器监控 存活/CPU/MEM/磁盘/LOAD</li>
<li>redis监控 存活/MEM/CPU/连接数/qps/最近一次fork时间/key命中率/key淘汰率/慢操作/持久化/主从同步/cluster/处理延迟</li>
<li style="list-style: none"><input type="checkbox"> redis持久化</li>
<li>RDB<br>fork子进程，生成快照，期间若有更新操作丢弃，等下次rdb</li>
<li>AOF<br>每次更新操作缓存起来，定期（可配置）持久化到磁盘，若临时文件较大启动rewrite进程，期间更新操作缓存到buf中，rewrite结束后追加buf；<br><a href="http://www.tuicool.com/articles/BBjeInz" target="_blank" rel="noopener">细说Redis监控和报警</a><br>###0614</li>
<li style="list-style: none"><input type="checkbox"> 面试和参加分享，学习boost.asio异步化框架的实现</li>
<li>两层epoll，一层负责监控底层套接字，与外界通信，一层负责和应用层套接字通信，采用proactor机制（经reactor实现）</li>
<li>async_connect, async_accept, async_recive, async_send等API</li>
<li>调试打印信息</li>
<li>学习C++11部分语法 std::move, auto, lamba机制</li>
<li style="list-style: none"><input type="checkbox"> 违章APP滚屏广告出现重复广告，排查后发现不同的广告主用的是同一张图片（根据广告主id去重）</li>
<li style="list-style: none"><input type="checkbox"> 增加Rs各业务线的redis集群报警</li>
</ul>
<ol>
<li>实时监控-&gt;主机监控-&gt;关联功能模块-&gt;应用模板-&gt;添加策略项</li>
<li>运维专用-&gt;监控项配置-&gt;搜索”auto_redis”对应的监控项</li>
<li>执行1中的添加策略项，添加2中找到的监控项，标签为port=”redis实例端口号”，一次填写完各项后保存退出</li>
</ol>
<p>###0613</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 理清autoredis migrate操作流程</li>
<li style="list-style: none"><input type="checkbox"> 熟悉Guardian原理以及运维环境</li>
<li style="list-style: none"><input type="checkbox"> 温习move-ask机制以及redis cluster master宕机处理<br>###0612</li>
<li style="list-style: none"><input type="checkbox"> 线上dspindex报警，buf长度小于消息长度，已重启服务，13号修复</li>
<li style="list-style: none"><input type="checkbox"> dspindex重启之前会去配置管理平台拉取最新的配置再重启服务</li>
<li style="list-style: none"><input type="checkbox"> 统计adx对接inmobi联盟数据，预曝光和曝光比恢复到符合预期值</li>
<li style="list-style: none"><input type="checkbox"> 协助报价APP联调测试</li>
<li style="list-style: none"><input type="checkbox"> 更新adx与inmobi交互的处理时常值并上线，验证线上效果ok</li>
</ul>
<p>##20170605-20170609</p>
<p>###0609</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 讨论inmobi联盟超时较多解决方案</li>
<li style="list-style: none"><input type="checkbox"> 下午休假<br>###0608</li>
<li style="list-style: none"><input type="checkbox"> 验证dspindex线上部署机器192.168.7.51监控报警是否恢复，符合预期，服务上线后超时率明显上升，超时率曲线与7.51机器上的服务部署时间契合，通知运维，运维切换网卡，效果待验证</li>
<li style="list-style: none"><input type="checkbox"> 数据统计7号晚21点违章APP收到的7千returncode=1的应答<br><img src="./IMG_20170608_104636_1_[B@150ef42.jpg" alt="Alt text"></li>
<li>2024广告位在访问inmobi后超时增多，不访问inmobi情况下超时率在千分之一左右，访问inmobi后涨到20%</li>
<li>和inmobi接口人确认后他们需要200ms的处理时间，修改后在线下测试发现基本不会出现之前的频繁超时情况，不过每访问10～20次左右会有连续几次超时，应该是对端的黑名单机制造成的</li>
<li style="list-style: none"><input type="checkbox"> 继续熟悉autoredis 集群式处理机制</li>
</ul>
<p>###0607</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 线上adx曝光和预曝光gap排查</li>
<li>查询adx广告位请求数<strong>grep logPreDeliver impress.2017060716|grep “apprtb.lua”|awk -F’\t’ ‘{if($8==2024) print $8}’|wc -l</strong></li>
<li>查询预曝光数<br>set mapreduce.job.queuename=q_tongyong;<br>select hour,count(1) from ods.o_ad_adx_pre_pvlog where dt=20170607 and adpos_id=2024 and deal_type=’NETWORK’ and hour=16 group by hour;</li>
<li>查询曝光数<br>set mapreduce.job.queuename=q_tongyong;<br>select hour,count(1) from ods.o_ad_adx_pvlog where dt=20170607 and adpos_id=2024 and deal_type=’NETWORK’ and hour=16 group by hour;</li>
<li>查询inmobi出广告数 <strong>grep -w logResponse impress.2017060716|grep -w 2024|awk -F’\t’ ‘{if($10==0) print 10}’|wc -l</strong></li>
<li>查询adx未返回广告数 <strong>grep logPreDeliver impress.2017060716|grep “apprtb.lua”|awk -F’\t’ ‘{if($8==2024) print 8, 12}’|awk ‘{if(NF!=2) print 0}’|wc -l</strong></li>
</ul>
<p>###0606</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 线上redis报警<strong>无可用连接</strong><ol>
<li>UserFeature集群大量key同时失效，造成redis性能下降（有过期监控，当只针对UserInfo集群，后续补上）</li>
</ol>
</li>
<li style="list-style: none"><input type="checkbox"> 线上dspindex没有报警，上游反馈经常连接失败<ol>
<li>报警平台找不到该机器，运维反应该机器有问题，已停掉</li>
<li>启动加载细节：从mysql读取全量和kafka最新offset</li>
</ol>
</li>
<li style="list-style: none"><input type="checkbox"> 熟悉autoredis系统<ol>
<li>autoredis-agent启动后在zookeeper的//__register_hosts路径下注册本机IP</li>
<li>新加业务线，选择//__register_hosts的节点信息</li>
<li>添加redis实例<ul>
<li>创建/autoredis/部门/业务/redis/host:port 实例节点<ul>
<li>实例节点的value={“action”: “none”, “path”: “/home/w/kvcluster3plus/123/redis/12301”, “version”: 1496799268706670}</li>
<li>实例节点下创建子节点feedback, value=’’</li>
<li>实例节点下创建子节点conf, value=redis默认配置</li>
<li>实例节点下创建子节点 script, value={“offline”: “/home/w/kvcluster3plus/123/redis/script/stop_redis.sh”, “online”: “/home/w/kvcluster3plus/123/redis/script/start_redis.sh”}</li>
</ul>
</li>
<li>创建/autoredis/listen/host:port监听实例节点<strong>Create(path=’/autoredis/listen/10.168.66.192/1496816740644’, data=’{“path”: [“/autoredis/adver2_test/123/redis/10.168.66.192:12301/conf”], “type”: 1}’, acl=[ACL(perms=31, acl_list=[‘ALL’], id=Id(scheme=’world’, id=’anyone’))], flags=0)</strong></li>
</ul>
</li>
<li>start redis实例<pre><code>- SetData(path=&apos;/autoredis/adver2_test/123/redis/10.168.66.192:12301&apos;, data=&apos;{&quot;action&quot;: &quot;online&quot;, &quot;path&quot;: &quot;/home/w/kvcluster3plus/123/redis/12301&quot;, &quot;version&quot;: 1496800896688466}&apos;, version=-1)
- Create(path=&apos;/autoredis/listen/10.168.66.192/1496800896694&apos;, data=&apos;{&quot;path&quot;: [&quot;/autoredis/adver2_test/123/redis/10.168.66.192:12301&quot;], &quot;type&quot;: 3}&apos;, acl=[ACL(perms=31, acl_list=[&apos;ALL&apos;], id=Id(scheme=&apos;world&apos;, id=&apos;anyone&apos;))], flags=0)
- autoredis-agent监控到节点变化，执行相应脚本后删除/autoredis/listen/10.168.66.192/1496799268730
</code></pre></li>
<li>stop redis实例<ul>
<li>SetData(path=’/autoredis/adver2_test/123/redis/10.168.66.192:12301’, data=’{“action”: “offline”, “path”: “/home/w/kvcluster3plus/123/redis/12301”, “version”: 1496801136252096}’, version=-1)</li>
<li>Create(path=’/autoredis/listen/10.168.66.192/1496801136263’, data=’{“path”: [“/autoredis/adver2_test/123/redis/10.168.66.192:12301”], “type”: 3}’, acl=[ACL(perms=31, acl_list=[‘ALL’], id=Id(scheme=’world’, id=’anyone’))], flags=0)</li>
<li>autoredis-agent监控到节点变化，执行相应脚本后删除/autoredis/listen/10.168.66.192/1496801136263</li>
</ul>
</li>
<li>delete redis实例<ul>
<li>Sending request(xid=743): Delete(path=’/autoredis/adver2_test/123/redis/10.168.66.192:12301/<strong>feedback,conf,script</strong>‘, version=-1)</li>
<li>Delete(path=’/autoredis/adver2_test/123/redis/10.168.66.192:12301’, version=-1)</li>
<li>Create(path=’/autoredis/listen/10.168.66.192/1496816035477’, data=’{“path”: [“/autoredis/adver2_test/123/redis/10.168.66.192:12301”, “/autoredis/adver2_test/123/redis/10.168.66.192:12301/feedback”, “/autoredis/adver2_test/123/redis/10.168.66.192:12301/script”, “/autoredis/adver2_test/123/redis/10.168.66.192:12301/conf”], “type”: 2}’, acl=[ACL(perms=31, acl_list=[‘ALL’], id=Id(scheme=’world’, id=’anyone’))], flags=0)</li>
<li>autoredis-agent监控到节点变化，执行相应脚本后删除/autoredis/listen/10.168.66.192/1496816035477</li>
</ul>
</li>
<li>同一机器部署多台redis实例&amp;启动<ul>
<li>Create(path=’/autoredis/adver2_test/123/redis/10.168.66.192:12302’, data=’{“action”: “none”, “path”: “/home/w/kvcluster3plus/123/redis/12302”, “version”: 1496816848825178}’, acl=[ACL(perms=31, acl_list=[‘ALL’], id=Id(scheme=’world’, id=’anyone’))], flags=0)</li>
<li>Create(path=’/autoredis/adver2_test/123/redis/10.168.66.192:12302/<strong>feedback, conf, script</strong>‘, data=’’, acl=[ACL(perms=31, acl_list=[‘ALL’], id=Id(scheme=’world’, id=’anyone’))], flags=0)</li>
<li>Create(path=’/autoredis/listen/10.168.66.192/1496816848887’, data=’{“path”: [“/autoredis/adver2_test/123/redis/10.168.66.192:12302/conf”], “type”: 1}’, acl=[ACL(perms=31, acl_list=[‘ALL’], id=Id(scheme=’world’, id=’anyone’))], flags=0)</li>
<li>启动</li>
<li>SetData(path=’/autoredis/adver2_test/123/redis/10.168.66.192:12302’, data=’{“action”: “online”, “path”: “/home/w/kvcluster3plus/123/redis/12302”, “version”: 1496817108429882}’, version=-1)</li>
<li>Create(path=’/autoredis/listen/10.168.66.192/1496817108435’, data=’{“path”: [“/autoredis/adver2_test/123/redis/10.168.66.192:12302”], “type”: 3}’, acl=[ACL(perms=31, acl_list=[‘ALL’], id=Id(scheme=’world’, id=’anyone’))], flags=0)</li>
</ul>
</li>
</ol>
</li>
</ul>
<blockquote>
<p> 线上开发机列表<br>10.168.66.187 洪斌    admin   LFHe$nF?48</p>
<p>10.168.66.188 洪斌    admin   Nr8eAyL!r3<br>10.168.66.189 洪斌    admin   AhF4ArE?F6<br>10.168.66.190 洪斌    admin   THe36hy+T3<br>10.168.66.191 洪斌    admin   Er%H<em>et#R4<br>10.168.66.192 洪斌    admin   RphF3q5%t5<br>10.168.66.193 洪斌    admin   Rtf!rfp</em>t5<br>10.168.66.194 洪斌    admin   THFphfH$e8<br>10.168.99.66               centos   D&gt;3A!636#=</p>
<p>###0605</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 线上机器连接数过高报警问题排查</li>
</ul>
<ol>
<li>查询进程端口的连接数发现9092端口超过25000个连接请求</li>
<li>查询进程信息<strong>kafka</strong>进程</li>
<li>查询部署信息获取业务模块信息</li>
<li>通报相关接口人</li>
</ol>
</blockquote>
<ul>
<li style="list-style: none"><input type="checkbox"> adx对接inmobi流量问题排查</li>
</ul>
<ol>
<li>联盟可用流量太低(车智投流量有100W，DSP请求有100W左右)，统计请求日志发现inmobi请求数在100W左右，符合预期，确认可用流量统计口径？</li>
<li>inmobi的投放量和曝光量差距50%左右，现正统计adx的预曝光数据和曝光数据</li>
<li>报表信息显示点击率双方数据gap在20%左右，因为统计时间区间不一致，需要inmobi提供一份基于北京时间的区间统计</li>
</ol>
<p>##20170531-20170602</p>
<p>###0602</p>
<ul>
<li style="list-style: none"><input type="checkbox"> Guardian</li>
<li>config.py记录redis部署信息以及主从配置，持久化配置</li>
<li>guardian.py主程序</li>
<li>every_one_min.sh 定期执行脚本 ping</li>
<li><strong>集群宕机处理</strong>查看redis_cluster_guardian.log日志，获取集群从节点信息（持久化），先启动从节点，通过持久化恢复后升级为主节点，然后再启动主节点（自动将为从节点）<ul>
<li>192.168.6.61</li>
<li>grep config= /root/autoredis_guardian/redis_cluster_guardian.log</li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> 查看聂璜辉周报关于redis部分，查看git log，里面有记录更新日志</li>
</ul>
<p>###0601</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 交接autoredis，在开发机部署autoredis（webserver, agent, zookeeper），通过操作熟悉代码</li>
<li style="list-style: none"><input type="checkbox"> zookeeper部署</li>
<li>创建autoredis <strong>3.0集群</strong></li>
<li>创建autoredis_single <strong>2.8集群</strong></li>
<li>创建autoredis_agent <strong>agent部署信息</strong></li>
<li>创建autoredis/migrate <strong>节点迁移信息</strong></li>
<li>创建autoredis/listen <strong>节点监控信息</strong></li>
<li>创建autoredis_single/listen <strong>节点监控信息</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">from kazoo.client import KazooClient</span><br><span class="line">obj = KazooClient(hosts=&quot;127.0.0.1:2181&quot;)</span><br><span class="line">obj.start()</span><br><span class="line">obj.ensure_path(&quot;/autoredis&quot;)</span><br><span class="line">obj.ensure_path(&quot;/autoredis_single&quot;)</span><br><span class="line">obj.ensure_path(&quot;/&quot;)</span><br><span class="line">obj.ensure_path(&quot;/autoredis/migrate&quot;)</span><br><span class="line">obj.ensure_path(&quot;/autoredis/listen&quot;)</span><br><span class="line">obj.ensure_path(&quot;/autoredis_single/listen&quot;)</span><br><span class="line">obj.stop()</span><br></pre></td></tr></table></figure>
<ul>
<li style="list-style: none"><input type="checkbox"> mysql部署<br>database:    <strong>autoredis</strong><br>table:    <strong>account_manager</strong><br>| Field      | Type     | Null | Key | Default | Extra |<br>| :——–: | :——–:| :——: |:——: |:——: |:——: |<br>| name       | char(20) | NO   | PRI | NULL    |       |<br>| password   | char(20) | NO   |     | NULL    |       |<br>| department | text     | YES  |     | NULL    |       |</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">name</th>
<th style="text-align:center">password</th>
<th style="text-align:center">department</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">aaaa</td>
<td style="text-align:center">aaaa</td>
<td style="text-align:center">admin,adver_test,engine_test</td>
</tr>
<tr>
<td style="text-align:center">admin</td>
<td style="text-align:center">admin123</td>
<td style="text-align:center">adver_test,adver2_test</td>
</tr>
<tr>
<td style="text-align:center">cuishengkai</td>
<td style="text-align:center">cuishengkai</td>
<td style="text-align:center">engine_test</td>
</tr>
<tr>
<td style="text-align:center">kisaragi</td>
<td style="text-align:center">kisaragi</td>
<td style="text-align:center">kanmusu1</td>
</tr>
<tr>
<td style="text-align:center">z</td>
<td style="text-align:center">z</td>
<td style="text-align:center">adver_test,adver2_test</td>
</tr>
</tbody>
</table>
<ul>
<li style="list-style: none"><input type="checkbox"> Webserver</li>
<li>admin账户登录，点击<strong>部门管理</strong>，显示admin对应的department值，可以执行新增部门操作，更新数据库，并在zookeeper的/autoredis，/autoredis_signle, /autoredis/migrate目录下创建新增部门的节点</li>
<li>点击<strong>账号管理</strong>, 输入用户名，密码，已经选择部门后更新操作，更新数据库</li>
</ul>
<p>###0531</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 讨论线上广告重复的问题，已确认adx支持内推去重，完成代码开发测试，待周四上线</li>
<li style="list-style: none"><input type="checkbox"> 熟悉redis集群上线部署操作</li>
<li>主从切换</li>
<li>新建集群</li>
<li style="list-style: none"><input type="checkbox"> 熟悉redis集群PPT，及各模块结构</li>
<li style="list-style: none"><input type="checkbox"> autoredis</li>
<li><strong>节点</strong><ul>
<li>Add/Delete/Start/Stop:<br>webserver-&gt;zookeeper-&gt;agent执行脚本,结果写回zookeeper,feedback值是webserver从zookeeper读取,Info值是直接从redis获取</li>
</ul>
</li>
<li><strong>集群</strong><ul>
<li>Init/Addin/Exitout/Replicate/keyslot等直接与redis交互</li>
<li>migrate进度通过与zookeeper交互获取<br>##20170522-20170527<br>###0526</li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> 线上验证功能</li>
</ul>
<ol>
<li>日志过于简单</li>
<li>曝光，可见曝光日志缺少os字段</li>
<li>deal_type逻辑有问题，已修复，已上线</li>
</ol>
<ul>
<li style="list-style: none"><input type="checkbox"> 上线碰到的问题</li>
</ul>
<ol>
<li>字段列数值限制（因为上线分批上的，需要兼容之前的字段数）</li>
<li>os字段两次上线均出现遗漏</li>
<li>IP处理问题</li>
<li>uniqid字段没出现在日志中，不方便排查问题</li>
</ol>
<blockquote>
<ul>
<li><strong>测试覆盖</strong>，一定要测试完整才上线，不要依赖QA</li>
<li><strong>没有单测</strong>，没有考虑更方便的功能验证</li>
<li><strong>提供的整体的联调环境&amp;mock上下游请求应答报文</strong><br>###0525</li>
<li style="list-style: none"><input type="checkbox"> RsQuChong业务redis集群部署迁移</li>
<li>现状：两台机器，3主3从，内存3GB</li>
<li>迁移需求：新增3台机器，3主，内存15GB</li>
<li>新加节点(<strong>主从切换&amp;slot迁移</strong>)<ol>
<li>在新增部署机器上部署redis_agent：参考<ul>
<li><a href="http://wiki.corpautohome.com/pages/viewpage.action?pageId=75542370" target="_blank" rel="noopener">redis&amp;proxy安装</a></li>
<li><a href="http://wiki.corpautohome.com/pages/viewpage.action?pageId=76624603" target="_blank" rel="noopener">agent安装</a></li>
</ul>
</li>
<li>节点管理3.0<ol>
<li>点击<strong>adver_engine</strong>-&gt;Product Name栏输入<strong>业务节点名</strong>-&gt;<strong>Agent List </strong>(显示所有机器)选中该业务节点下所有机器（包括已有机器和新增机器）-&gt;更新</li>
<li>点击<strong>业务节点</strong>-&gt;点击<strong>Add</strong>-&gt;输入ip, 端口，内存预留值-&gt;选中节点-&gt;点击<strong>Start</strong></li>
</ol>
</li>
<li>集群管理3.0<ol>
<li>点击<strong>业务节点</strong>-&gt;选中新加机器-&gt;<strong>Addin</strong>(初始化为master角色，没有slot，没有从)</li>
<li>依次执行（选中机器-&gt;replicate-&gt;输入master ip:port），成为其他master的slave，加入组</li>
<li><strong>主从切换</strong> 远程执行/home/w/bin/redis/redis-cli -h ip -p port cluster failover，成为master，等待同步完成</li>
<li><strong>slot迁移</strong>点击migrate-&gt;迁出节点选择ALL-&gt;迁移个数选择16384/len(master)-&gt;选择新增节点-&gt;点击开始</li>
<li><strong>移除节点</strong>（如果是master，先迁移出slot）选中节点，点击<strong>Exitout</strong>后进入节点管理找到相应节点的redis点击<strong>stop</strong>,因为退出存在连接这点节点的客户端更新路由表，这样就获取到退出后的路由表信息，这样该客户端就存在获取不到数据</li>
<li><strong>新建集群</strong>选中所有节点-&gt;点击<strong>Init</strong><br>###0524</li>
</ol>
</li>
</ol>
</li>
<li style="list-style: none"><input type="checkbox"> 优化dspindex读取kafka异常处理</li>
<li style="list-style: none"><input type="checkbox"> 搭建conda + tushare环境，熟悉股票开源数据</li>
<li style="list-style: none"><input type="checkbox"> 熟悉python开发语言及科学库numpy, pands</li>
<li style="list-style: none"><input type="checkbox"> 调研引擎端（adx+dsp+车智投） + 业务端（dsp）上线计划</li>
</ul>
<ol>
<li>业务端那边上线需要停增量，需要告知业务方，DBA，并提供回滚计划</li>
<li>引擎端已提供兼容方案，</li>
</ol>
</blockquote>
<p>###0523</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 熟悉dspindex索引结构</li>
<li style="list-style: none"><input type="checkbox"> 解决测试中遇到的问题</li>
<li style="list-style: none"><input type="checkbox"> 准备串讲大纲<br>###0522</li>
<li style="list-style: none"><input type="checkbox"> 调研dspindex索引结构</li>
<li><p>[ ] 查看adx click处理逻辑</p>
</li>
<li><p>click链接<br>/click?<strong>t=MS4wCTBlYjNlNjhiLTRhMDctNDc4Yy1iMzRhLTU1MTUyZWRjMDg2NAk0NTc1ZDA3Ni1mMDdlLTQ5ZTAtOTI4MS1hZDQ3ODRhOTMzZDMJMTMJMjcxMgkxMTcxCTU2NDgxCWh0dHA6Ly9jYXIubS5hdXRvaG9tZS5jb20uY24vcGljL3Nlcmllcy80MDcyLmh0bWwJJSVDTElDS19VUkxfVU5FU0MlJSZ1cmw9aHR0cCUzQSUyRiUyRmRzcG1udC5hdXRvaG9tZS5jb20uY24lMkZtb25pdG9yJTNGcnR5cGUlM0QyJTI2ZHBtayUzRFdMcnZZMUhPeGs1c0xuUFFJaGpnV0tkcEhRdWpNaVB6dVJRQ0hmQjhlNnJsZmxwZTQzSjhwdWx6V1VMd05qejN1R2xWVE9JaktLMjVmVmNNJTI1MkYzSXJydXRtVzFucUpXZjg3MzhPUSUyNTJCZHplNnZ1TGdzTjRuNThxdjVuVFF5N0lpUDYlMjUyRm5GTld1ZHhmJTI1MkZyc2ZGbER0SFo5JTI1MkIlMjUyRkYlMjUyRlZndmlhM09zNUhwQ0Q3WnlmYWJvS2xaZDRTSjV2UEJwRGdxcUx5Njg1bWxlVFA1a0slMjUyRnFzSkJ3SHRtUnd2TzU4WGx6d2FtanJyeTRkQjdaa2NMenJmeTVhNUhJUHF2RUpLVnFRYTM2bW1naENWcEJ4ZmJQa2YxMVlsSFlJMjU5JTI1MkJWMTN3YW1qdXNDb2JDTDAwSjd6bWFWNWU0M2Q2ck94N1gxendhbWp6c3lrR0FyY1pKZTMlMjUyQmNVMWY0bmQ3cnVoN1gxN2paR2E4cVNVR0dyc2lhS1R1ZUZsZiUyNTJGbVFwN0xrcUd3ZWtJeVA2JTI1MkZuRmRXJTI1MkJOJTI1MkJjN0wlMjUyQktnc1l0elElMjUyQjk3aHBWVnpyY0hLdjhHa0NENm9aT3V5MUtBcE02SGQ0cnV4blRReTdJaFh1cmlJTUMlMjUyRkI4ZWE3dGZGNUM4Q1VsN2FnVUFnRzJJMmlrN1dkTkRiMDFQc0c2S2d3YXZUUm9wT3hsWDFyaGNYJTI1MkJ1NzNOWldPcHplNjN1Y2xkQzhDVW05NzhnTUJ1Z0ttaWslMjUyRmlNYkdxSTFjTEh6SmtFRHN5b21zTDAlMjUyQkd3RzZLU2Y3OGlnQUElMjUyRndsSkxHdlBnMEV0eVUlMjUyQnNlNTdYbG45YzJYbXYyUk1IcVFuT1B1OUlndFQ0SE55cmU1elhreiUyNTJCWkRuN3Z5UUJDbzBrSSUyNTJGciUyNTJCY1Z4ZTQzRjdzdjRvRGhxM0lTWHNwV2xWWGVSMmVlTSUyNTNEJTI2YXhkJTNEMSUyNmFoeHAlM0RvVDMzOGpXN1E3R3haWDk3Z1NEWm1aQiUyNTJCU09TVnFwNmpRWEVlNXclMjUzRCUyNTNECTExNC4yNTAuMjI3LjE0MAk3NEE0NjRFNC1CRjRCLTQ4RkMtOEI3Ny04NDI2RjBCRUM1ODMlN0MlN0MyMDE3LTA1LTIzJTJCMDglM0E1NSUzQTQ3Ljc0NiU3QyU3QzAJCVJUQgkxNDk1NTAxNDY4CTMJ</strong>&amp;url=http%3A%2F%2Fdspmnt.autohome.com.cn%2Fmonitor%3Frtype%3D2%26dpmk%3DWLrvY1HOxk5sLnPQIhjgWKdpHQujMiPzuRQCHfB8e6rlflpe43J8pulzWULwNjz3uGlVTOIjKK25fVcM%252F3IrrutmW1nqJWf8738OQ%252Bdze6vuLgsN4n58qv5nTQy7IiP6%252FnFNWudxf%252FrsfFlDtHZ9%252B%252FF%252FVgvia3Os5HpCD7ZyfaboKlZd4SJ5vPBpDgqqLy685mleTP5kK%252FqsJBwHtmRwvO58Xlzwamjrry4dB7ZkcLzrfy5a5HIPqvEJKVqQa36mmghCVpBxfbPkf11YlHYI259%252BV13wamjusCobCL00J7zmaV5e43d6rOx7X1zwamjzsykGArcZJe3%252BcU1f4nd7ruh7X17jZGa8qSUGGrsiaKTueFlf%252FmQp7LkqGwekIyP6%252FnFdW%252BN%252Bc7L%252BKgsYtzQ%252B97hpVVzrcHKv8GkCD6oZOuy1KApM6Hd4ruxnTQy7IhXuriIMC%252FB8ea7tfF5C8CUl7agUAgG2I2ik7WdNDb01PsG6KgwavTRopOxlX1rhcX%252Bu73NZWOpze63ucldC8CUm978gMBugKmik%252FiMbGqI1cLHzJkEDsyomsL0%252BGwG6KSf78igAA%252FwlJLGvPg0EtyU%252Bse57Xln9c2Xmv2RMHqQnOPu9IgtT4HNyre5zXkz%252BZDn7vyQBCo0kI%252Fr%252BcVxe43F7sv4oDhq3ISXspWlVXeR2eeM%253D%26axd%3D1%26ahxp%3DoT338jW7Q7GxZX97gSDZmZB%252BSOSVqp6jQXEe5w%253D%253D</p>
<ol>
<li>获取t参数<br>MS4wCTBlYjNlNjhiLTRhMDctNDc4Yy1iMzRhLTU1MTUyZWRjMDg2NAk0NTc1ZDA3Ni1mMDdlLTQ5ZTAtOTI4MS1hZDQ3ODRhOTMzZDMJMTMJMjcxMgkxMTcxCTU2NDgxCWh0dHA6Ly9jYXIubS5hdXRvaG9tZS5jb20uY24vcGljL3Nlcmllcy80MDcyLmh0bWwJJSVDTElDS19VUkxfVU5FU0MlJSZ1cmw9aHR0cCUzQSUyRiUyRmRzcG1udC5hdXRvaG9tZS5jb20uY24lMkZtb25pdG9yJTNGcnR5cGUlM0QyJTI2ZHBtayUzRFdMcnZZMUhPeGs1c0xuUFFJaGpnV0tkcEhRdWpNaVB6dVJRQ0hmQjhlNnJsZmxwZTQzSjhwdWx6V1VMd05qejN1R2xWVE9JaktLMjVmVmNNJTI1MkYzSXJydXRtVzFucUpXZjg3MzhPUSUyNTJCZHplNnZ1TGdzTjRuNThxdjVuVFF5N0lpUDYlMjUyRm5GTld1ZHhmJTI1MkZyc2ZGbER0SFo5JTI1MkIlMjUyRkYlMjUyRlZndmlhM09zNUhwQ0Q3WnlmYWJvS2xaZDRTSjV2UEJwRGdxcUx5Njg1bWxlVFA1a0slMjUyRnFzSkJ3SHRtUnd2TzU4WGx6d2FtanJyeTRkQjdaa2NMenJmeTVhNUhJUHF2RUpLVnFRYTM2bW1naENWcEJ4ZmJQa2YxMVlsSFlJMjU5JTI1MkJWMTN3YW1qdXNDb2JDTDAwSjd6bWFWNWU0M2Q2ck94N1gxendhbWp6c3lrR0FyY1pKZTMlMjUyQmNVMWY0bmQ3cnVoN1gxN2paR2E4cVNVR0dyc2lhS1R1ZUZsZiUyNTJGbVFwN0xrcUd3ZWtJeVA2JTI1MkZuRmRXJTI1MkJOJTI1MkJjN0wlMjUyQktnc1l0elElMjUyQjk3aHBWVnpyY0hLdjhHa0NENm9aT3V5MUtBcE02SGQ0cnV4blRReTdJaFh1cmlJTUMlMjUyRkI4ZWE3dGZGNUM4Q1VsN2FnVUFnRzJJMmlrN1dkTkRiMDFQc0c2S2d3YXZUUm9wT3hsWDFyaGNYJTI1MkJ1NzNOWldPcHplNjN1Y2xkQzhDVW05NzhnTUJ1Z0ttaWslMjUyRmlNYkdxSTFjTEh6SmtFRHN5b21zTDAlMjUyQkd3RzZLU2Y3OGlnQUElMjUyRndsSkxHdlBnMEV0eVUlMjUyQnNlNTdYbG45YzJYbXYyUk1IcVFuT1B1OUlndFQ0SE55cmU1elhreiUyNTJCWkRuN3Z5UUJDbzBrSSUyNTJGciUyNTJCY1Z4ZTQzRjdzdjRvRGhxM0lTWHNwV2xWWGVSMmVlTSUyNTNEJTI2YXhkJTNEMSUyNmFoeHAlM0RvVDMzOGpXN1E3R3haWDk3Z1NEWm1aQiUyNTJCU09TVnFwNmpRWEVlNXclMjUzRCUyNTNECTExNC4yNTAuMjI3LjE0MAk3NEE0NjRFNC1CRjRCLTQ4RkMtOEI3Ny04NDI2RjBCRUM1ODMlN0MlN0MyMDE3LTA1LTIzJTJCMDglM0E1NSUzQTQ3Ljc0NiU3QyU3QzAJCVJUQgkxNDk1NTAxNDY4CTMJ</li>
<li>base64解码<br>1.0<br>0eb3e68b-4a07-478c-b34a-55152edc0864    4575d076-f07e-49e0-9281-ad4784a933d3<br>13<br>2712<br>1171<br>56481<br><a href="http://car.m.autohome.com.cn/pic/series/4072.html" target="_blank" rel="noopener">http://car.m.autohome.com.cn/pic/series/4072.html</a>    <strong>请求页面</strong> %%CLICK_URL_UNESC%%&amp;url=http%3A%2F%2Fdspmnt.autohome.com.cn%2Fmonitor%3Frtype%3D2%26dpmk%3DWLrvY1HOxk5sLnPQIhjgWKdpHQujMiPzuRQCHfB8e6rlflpe43J8pulzWULwNjz3uGlVTOIjKK25fVcM%252F3IrrutmW1nqJWf8738OQ%252Bdze6vuLgsN4n58qv5nTQy7IiP6%252FnFNWudxf%252FrsfFlDtHZ9%252B%252FF%252FVgvia3Os5HpCD7ZyfaboKlZd4SJ5vPBpDgqqLy685mleTP5kK%252FqsJBwHtmRwvO58Xlzwamjrry4dB7ZkcLzrfy5a5HIPqvEJKVqQa36mmghCVpBxfbPkf11YlHYI259%252BV13wamjusCobCL00J7zmaV5e43d6rOx7X1zwamjzsykGArcZJe3%252BcU1f4nd7ruh7X17jZGa8qSUGGrsiaKTueFlf%252FmQp7LkqGwekIyP6%252FnFdW%252BN%252Bc7L%252BKgsYtzQ%252B97hpVVzrcHKv8GkCD6oZOuy1KApM6Hd4ruxnTQy7IhXuriIMC%252FB8ea7tfF5C8CUl7agUAgG2I2ik7WdNDb01PsG6KgwavTRopOxlX1rhcX%252Bu73NZWOpze63ucldC8CUm978gMBugKmik%252FiMbGqI1cLHzJkEDsyomsL0%252BGwG6KSf78igAA%252FwlJLGvPg0EtyU%252Bse57Xln9c2Xmv2RMHqQnOPu9IgtT4HNyre5zXkz%252BZDn7vyQBCo0kI%252Fr%252BcVxe43F7sv4oDhq3ISXspWlVXeR2eeM%253D%26axd%3D1%26ahxp%3DoT338jW7Q7GxZX97gSDZmZB%252BSOSVqp6jQXEe5w%253D%253D    <strong>跳转链接</strong><br>114.250.227.140<br>74A464E4-BF4B-48FC-8B77-8426F0BEC583%7C%7C2017-05-23%2B08%3A55%3A47.746%7C%7C0<br>RTB<br>1495501468<br>3    </li>
<li>获取跳转链接<br>http%3A%2F%2Fdspmnt.autohome.com.cn%2Fmonitor%3Frtype%3D2%26dpmk%3DWLrvY1HOxk5sLnPQIhjgWKdpHQujMiPzuRQCHfB8e6rlflpe43J8pulzWULwNjz3uGlVTOIjKK25fVcM%252F3IrrutmW1nqJWf8738OQ%252Bdze6vuLgsN4n58qv5nTQy7IiP6%252FnFNWudxf%252FrsfFlDtHZ9%252B%252FF%252FVgvia3Os5HpCD7ZyfaboKlZd4SJ5vPBpDgqqLy685mleTP5kK%252FqsJBwHtmRwvO58Xlzwamjrry4dB7ZkcLzrfy5a5HIPqvEJKVqQa36mmghCVpBxfbPkf11YlHYI259%252BV13wamjusCobCL00J7zmaV5e43d6rOx7X1zwamjzsykGArcZJe3%252BcU1f4nd7ruh7X17jZGa8qSUGGrsiaKTueFlf%252FmQp7LkqGwekIyP6%252FnFdW%252BN%252Bc7L%252BKgsYtzQ%252B97hpVVzrcHKv8GkCD6oZOuy1KApM6Hd4ruxnTQy7IhXuriIMC%252FB8ea7tfF5C8CUl7agUAgG2I2ik7WdNDb01PsG6KgwavTRopOxlX1rhcX%252Bu73NZWOpze63ucldC8CUm978gMBugKmik%252FiMbGqI1cLHzJkEDsyomsL0%252BGwG6KSf78igAA%252FwlJLGvPg0EtyU%252Bse57Xln9c2Xmv2RMHqQnOPu9IgtT4HNyre5zXkz%252BZDn7vyQBCo0kI%252Fr%252BcVxe43F7sv4oDhq3ISXspWlVXeR2eeM%253D%26axd%3D1%26ahxp%3DoT338jW7Q7GxZX97gSDZmZB%252BSOSVqp6jQXEe5w%253D%253D</li>
<li>url解码并跳转<br><a href="http://dspmnt.autohome.com.cn/monitor?rtype=2&amp;dpmk=WLrvY1HOxk5sLnPQIhjgWKdpHQujMiPzuRQCHfB8e6rlflpe43J8pulzWULwNjz3uGlVTOIjKK25fVcM%2F3IrrutmW1nqJWf8738OQ%2Bdze6vuLgsN4n58qv5nTQy7IiP6%2FnFNWudxf%2FrsfFlDtHZ9%2B%2FF%2FVgvia3Os5HpCD7ZyfaboKlZd4SJ5vPBpDgqqLy685mleTP5kK%2FqsJBwHtmRwvO58Xlzwamjrry4dB7ZkcLzrfy5a5HIPqvEJKVqQa36mmghCVpBxfbPkf11YlHYI259%2BV13wamjusCobCL00J7zmaV5e43d6rOx7X1zwamjzsykGArcZJe3%2BcU1f4nd7ruh7X17jZGa8qSUGGrsiaKTueFlf%2FmQp7LkqGwekIyP6%2FnFdW%2BN%2Bc7L%2BKgsYtzQ%2B97hpVVzrcHKv8GkCD6oZOuy1KApM6Hd4ruxnTQy7IhXuriIMC%2FB8ea7tfF5C8CUl7agUAgG2I2ik7WdNDb01PsG6KgwavTRopOxlX1rhcX%2Bu73NZWOpze63ucldC8CUm978gMBugKmik%2FiMbGqI1cLHzJkEDsyomsL0%2BGwG6KSf78igAA%2FwlJLGvPg0EtyU%2Bse57Xln9c2Xmv2RMHqQnOPu9IgtT4HNyre5zXkz%2BZDn7vyQBCo0kI%2Fr%2BcVxe43F7sv4oDhq3ISXspWlVXeR2eeM%3D&amp;axd=1&amp;ahxp=oT338jW7Q7GxZX97gSDZmZB%2BSOSVqp6jQXEe5w%3D%3D" target="_blank" rel="noopener">http://dspmnt.autohome.com.cn/monitor?rtype=2&amp;dpmk=WLrvY1HOxk5sLnPQIhjgWKdpHQujMiPzuRQCHfB8e6rlflpe43J8pulzWULwNjz3uGlVTOIjKK25fVcM%2F3IrrutmW1nqJWf8738OQ%2Bdze6vuLgsN4n58qv5nTQy7IiP6%2FnFNWudxf%2FrsfFlDtHZ9%2B%2FF%2FVgvia3Os5HpCD7ZyfaboKlZd4SJ5vPBpDgqqLy685mleTP5kK%2FqsJBwHtmRwvO58Xlzwamjrry4dB7ZkcLzrfy5a5HIPqvEJKVqQa36mmghCVpBxfbPkf11YlHYI259%2BV13wamjusCobCL00J7zmaV5e43d6rOx7X1zwamjzsykGArcZJe3%2BcU1f4nd7ruh7X17jZGa8qSUGGrsiaKTueFlf%2FmQp7LkqGwekIyP6%2FnFdW%2BN%2Bc7L%2BKgsYtzQ%2B97hpVVzrcHKv8GkCD6oZOuy1KApM6Hd4ruxnTQy7IhXuriIMC%2FB8ea7tfF5C8CUl7agUAgG2I2ik7WdNDb01PsG6KgwavTRopOxlX1rhcX%2Bu73NZWOpze63ucldC8CUm978gMBugKmik%2FiMbGqI1cLHzJkEDsyomsL0%2BGwG6KSf78igAA%2FwlJLGvPg0EtyU%2Bse57Xln9c2Xmv2RMHqQnOPu9IgtT4HNyre5zXkz%2BZDn7vyQBCo0kI%2Fr%2BcVxe43F7sv4oDhq3ISXspWlVXeR2eeM%3D&amp;axd=1&amp;ahxp=oT338jW7Q7GxZX97gSDZmZB%2BSOSVqp6jQXEe5w%3D%3D</a></li>
</ol>
</li>
</ul>
<p>##20170515-20170519</p>
<p>###0519</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 搭建《利用python进行数据分析》的开发环境</li>
<li style="list-style: none"><input type="checkbox"> 关于UA配置联系APP端，inmobi端联调<br>###0518</li>
<li style="list-style: none"><input type="checkbox"> 配合测试</li>
<li style="list-style: none"><input type="checkbox"> 熟悉启动，加载数据脚本，gdb调试dspindex</li>
<li style="list-style: none"><input type="checkbox"> 补充dspindex单测<br>###0517</li>
<li style="list-style: none"><input type="checkbox"> 熟悉代码结构&amp;搭建开发环境</li>
<li>DspIndexServer.cpp <strong>程序入口</strong></li>
<li>IndexService.cpp <strong>服务启动前的初始化</strong><ul>
<li>CInvertConverter</li>
<li>CLoadHandler</li>
<li>CUpdateHandler<ol>
<li>获取当日位移</li>
<li>判断次日缓存有无数据<ul>
<li>若有<ul>
<li>若次日全量加载完成，则保存当日位移，获取缓存中的次日位移，读取kafka数据更新次日缓存后再拿到当日缓存</li>
<li>若次日全量未加载完成，则push到缓存队列，</li>
</ul>
</li>
<li>若没有则获取当日位移，读取kafka数据更新当日索引</li>
</ul>
</li>
<li>往复1，2步</li>
</ol>
</li>
<li>CRankFilter</li>
<li>启动SP_Server框架监听服务</li>
</ul>
</li>
<li>SearchHandler.cpp <strong>业务处理逻辑</strong><ul>
<li>Codec.cpp <strong>请求，应答报文的编解码</strong></li>
<li>CIndexManager <strong>主备索引切换</strong></li>
<li>CIndexWrapper <strong>继承CIndex，提供检索，更新索引功能</strong></li>
<li>IndexBuilder.cpp <strong>检索表达式构建</strong></li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> 修改adx测试存在的问题</li>
</ul>
<p>###0516</p>
<ul>
<li style="list-style: none"><input type="checkbox"> adx提测</li>
<li>内推优先级提交cr并ci到master分支</li>
<li>对接inmobi代码提交到inmobi分支，并协助测试mock inmobi应答包</li>
<li style="list-style: none"><input type="checkbox"> 熟悉dspindex</li>
<li>熟悉处理流程，获取构建开发，联调环境的数据<br><img src="./1495000120555.png" alt="Alt text"></li>
</ul>
<p>###0515</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 交接dspindex工作</li>
</ul>
<ol>
<li>熟悉业务</li>
<li>熟悉索引结构及更新流程<ul>
<li>每天晚上9点开始推第二天全量数据</li>
<li>dspindex每天需要加载当天的全量索引（百度的biz模块时刻更新投放计划，索引端只需增量更新索引数据）</li>
</ul>
</li>
</ol>
<ul>
<li style="list-style: none"><input type="checkbox"> adx支持客户去重功能 <strong>每次请求的多个广告位返回的广告中任意两个不能来自同一广告主</strong></li>
<li>车智投返回的广告添加uniqid去重码，adx保存所有车智投返回的去重码，并同步给dsp，dsp内部去重</li>
<li>已完成功能实现</li>
<li>基于新master分支提交cr，预期周三提测</li>
<li style="list-style: none"><input type="checkbox"> adx对接inmobi提测</li>
</ul>
<p>##20170509-20170512</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 对接inMobi联盟接口开发</li>
<li style="list-style: none"><input type="checkbox"> proxy继续压测</li>
</ul>
<p>##20170502-20170506</p>
<p>###0505</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 测试adx优先级ok<br>###0504</li>
<li style="list-style: none"><input type="checkbox"> 协助在新机器部署redis集群</li>
<li>centOS 7版本yum安装会产生冲突，rpm –i –replication *.rpm</li>
<li>了解对接inMobi时解包组包接口</li>
</ul>
<p>###0503</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 线下压测proxy</li>
<li><p><strong>线上value长度</strong><br><img src="./1493862259702.png" alt="Alt text"></p>
</li>
<li><p><strong>value 2M</strong><br><img src="./1493864455434.png" alt="Alt text"><br><img src="./1493861726700.png" alt="Alt text"></p>
</li>
<li><p><strong>value 20K</strong><br><img src="./1493863785795.png" alt="Alt text"><br><img src="./1493862745604.png" alt="Alt text"></p>
</li>
<li style="list-style: none"><input type="checkbox"> 调研golang的bufio</li>
</ul>
<ol>
<li>越界检查机制</li>
</ol>
<ul>
<li style="list-style: none"><input type="checkbox"> redis-cluster部署</li>
</ul>
<ol>
<li>sudo yum install -y autoredis-agent</li>
<li></li>
</ol>
<p>###0502<br><img src="./codis_commend.png" alt="Alt text"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">session-&gt;loopWriter:创建协程</span><br><span class="line">session-&gt;loopReader:Req</span><br><span class="line">loopReader-&gt;loopWriter:Request channel</span><br><span class="line">Note right of loopReader:router Dispatch</span><br><span class="line">Note right of loopWriter:阻塞等待request done</span><br><span class="line">loopWriter-&gt;session:Res</span><br><span class="line">loopReader-&gt;slot.bc:</span><br><span class="line">slot.bc-&gt;newBackendReader:创建协程</span><br><span class="line">slot.bc-&gt;bcloopWriter:请求redis</span><br><span class="line">bcloopWriter-&gt;newBackendReader:channel</span><br><span class="line">newBackendReader-&gt;loopWriter:done</span><br></pre></td></tr></table></figure></p>
<p>##20170424-20170428</p>
<p>###0428</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 熟悉使用新编辑器vsc，良好支持C++,python，lua， go等</li>
<li style="list-style: none"><input type="checkbox"> codis-proxy代码解析</li>
<li>对bc，request的channel还有点没掌握</li>
</ul>
<p>###0427</p>
<ul>
<li style="list-style: none"><input type="checkbox"> codis-proxy代码解析</li>
</ul>
<ol>
<li>main.go初始化，申请proxy</li>
<li>proxy.go<br>###0426</li>
</ol>
<ul>
<li style="list-style: none"><input type="checkbox"> 温习go，熟悉codis-proxy代码，gdb调试go</li>
<li><strong>DONE</strong> main.go,proxy.go</li>
<li><strong>TODO</strong> route.go redis.go session.go</li>
<li style="list-style: none"><input type="checkbox"> 追查jedis返回redis read timeout问题</li>
<li>域名解析超时(两台机器，一台已指定HOST，另一台走域名解析，对比观察效果)</li>
<li>proxy gc(超时时间300ms，gc不用这么长时间)</li>
<li>网络抖动</li>
<li>redis慢操作(没有慢操作日志)<br>###0425</li>
<li style="list-style: none"><input type="checkbox"> 机器学习入门</li>
<li>生活中的例子<br>每周日下午带孩子去鸟巢附近的天虹商场参加培训，出门时需要地铁出行还是开车，根据<strong>以往的经验判断是否堵车</strong><ul>
<li>经验 <em>训练数据，以下8个特征的取值对拥堵概率有较大影响，权重较高</em><ul>
<li>天气 <em>下雨堵车概率大</em></li>
<li>节假日 <em>节日返京客流大，堵车概率大</em></li>
<li>附近商场有无活动</li>
<li>红绿灯是否正常</li>
<li>剐蹭事故</li>
<li>突发事件</li>
<li>车流量 <em>通行力有限，车流量大堵车概率大</em></li>
<li>大货车 <em>大货车会导致通行力下降</em></li>
</ul>
</li>
<li>经验总结 <em>模型</em>        <ul>
<li>xi 表示每个特征的取值</li>
<li>yi 表示每个特征的权重</li>
<li>f(x) 表示堵车的概率<br>$$f(x) = x1<em>y1 + x2</em>y2 + … + xn*yn$$</li>
</ul>
</li>
<li>判断 <em>根据模型来预测</em><br>根据最后取值的范围区间来判断是否堵车     <strong>线性回归</strong></li>
</ul>
</li>
<li><p>机器学习定义</p>
<ul>
<li>通过学习给机器赋能，完成之前通过直接编程不能完成的事情</li>
<li>机器通过对历史数据(经验)的建模(归纳总结)，通过模型完成对未来的预测(决策)<br><img src="http://images.cnitblog.com/blog/673793/201412/221227224214301.png" alt=""></li>
</ul>
</li>
<li><p>机器学习应用场景</p>
<ul>
<li>语音识别</li>
<li>计算机视觉</li>
<li>自然语言处理</li>
<li>ctr预估</li>
<li>自动驾驶</li>
</ul>
</li>
<li>机器学习算法<ul>
<li>回归 监督学习</li>
<li>神经网络 监督学习</li>
<li>svm 监督学习</li>
<li>聚类 无监督学习</li>
<li>推荐 强化学习</li>
</ul>
</li>
<li>人工智能<ul>
<li>快速运算 – <strong>云计算</strong></li>
<li>大数据 – <strong>分布式</strong></li>
<li>反馈机制 – <strong>事件驱动</strong></li>
<li>知识集 – <strong>搜索引擎 + 推荐引擎</strong></li>
<li>归纳 + 推导 – <strong>机器学习</strong><br>###0424</li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> 组织adx内推优先级评审</li>
<li>仅支持自家DSP</li>
<li>dsp响应日志增加deal type</li>
<li>日志增加platform和os</li>
<li style="list-style: none"><input type="checkbox"> 了解机器学习</li>
<li>机器学习分类(监督学习/非监督学习/强化学习)</li>
<li>输入输出判断学习分类</li>
<li>常见算法<ul>
<li>贝叶斯</li>
<li>线性回归</li>
<li>隐马可尔夫模型</li>
<li>svm支持向量机<br>##20170417-20170421<br>###0421</li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> 修改日志，增加os，platform字段</li>
<li style="list-style: none"><input type="checkbox"> 晚上评审文档<br>###0420</li>
<li style="list-style: none"><input type="checkbox"> 继续梳理adx代码</li>
<li style="list-style: none"><input type="checkbox"> 完成评审文档</li>
<li style="list-style: none"><input type="checkbox"> 初步方案</li>
<li>extractAdBid:若广告类型为内推,不执行table.insert(adBidList[ad.slotid], temp)</li>
<li>ip_winner赋值</li>
<li>adData.adInternalPromotionTable[ad.slotid] =  ip_winner</li>
<li>遍历广告位,若该广告位没有投放,fillAdCreativeListForDsp(adPosId, ip_winner, adPendList, adCreativeList)</li>
</ul>
<p>###0419</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 计算table长度<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">j = len(arr)</span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> (j - i &gt; <span class="number">1</span>) &#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> m = (i+j)/<span class="number">2</span>;</span><br><span class="line">  <span class="keyword">if</span> (ttisnil(&amp;t-&gt;<span class="built_in">array</span>[m - <span class="number">1</span>])) j = m;</span><br><span class="line">  <span class="keyword">else</span> i = m;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> i;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="./table-len.png" alt="Alt text"></p>
<ul>
<li style="list-style: none"><input type="checkbox"> 梳理adx代码逻辑</li>
<li>dsp,position,network, networkpsid,creative继承object</li>
<li>启动时执行manage/initobject<ul>
<li>util.flushAllDict() <em>清空共享内存</em></li>
<li>object:cacheInfoSD() <em>load db数据加载至共享内存</em></li>
</ul>
</li>
<li>impress<ul>
<li>ngx.ctx.adReq <em>请求数据</em></li>
<li>ngx.ctx.adData <em>请求处理中间数据</em><ul>
<li>adPendList   {123,3030,3203}<br><em>有效广告位集合，若广告位已匹配广告，则remove</em></li>
<li>dspQueryList {1 = {123, 3030}, 2 = {3030, 3203}} ** </li>
<li>adPDBTable<br><em>key: psid; value: dspid</em></li>
<li>adPvidTable<br><em>每次广告位的每次请求都会生成pvid</em></li>
<li>adTagidTable<br><em>key: tagid; value: psid</em></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>###0418</p>
<ul>
<li><p>[ ] 搭建adx开发环境<br>类 = 属性 + 方法<br>属性：值        table.key : table.value，<br>方法                函数名：函数 table.key:table.value<br>_M  = {}<br>_M. __index = _M<br>_M.setID = function (self, id) … end<br>_M.getID = function(self) … end<br>_M.new = function()<br>  local t = {}<br>  setmetatable(t, _M)<br>  return t<br>end</p>
</li>
<li><p>[ ] 熟悉DSP 内推广告数据库结构</p>
</li>
<li>DSP投放的广告分商广 + 内推，内推广告优先级放在联盟之后，全局打底之前</li>
<li>dsp返回的广告需要标识广告类型，adx识别后再处理</li>
<li style="list-style: none"><input type="checkbox"> 评审ADX对接InMobi联盟设计</li>
<li>确认细节问题<ul>
<li>响应编码问题，部分字段编码</li>
<li>图片链接是icon？sceenshot?</li>
<li>广告位ID + 联盟ID + 设备OS -&gt; 联盟广告位ID</li>
<li>广告位ID(APPID) + 联盟ID + 设备OS -&gt; BundlerID (networkpsid加一列)</li>
</ul>
</li>
</ul>
<p>###0417</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 获取对接字段，并赋值，测试编码准确性</li>
<li style="list-style: none"><input type="checkbox"> 熟悉新需求</li>
</ul>
<p>##20170410-20170414</p>
<p>##0414</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 熟悉adx代码</li>
<li>appimpress.lua</li>
<li>appunion.lua<ul>
<li>getReqs 解析请求，并序列化请求</li>
<li>handleResps获取响应包，并反序列化响应<br>##0413</li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> indexserver分享</li>
<li>业务需求<ul>
<li>每天9点左右生成一份广告投放排期，更新索引</li>
<li>支持当天的实时更新数据</li>
<li>接收请求（带参数），拉取倒排，取交取并后先进行预排序，再rank，fill后再返回</li>
</ul>
</li>
<li>实现<ul>
<li>倒排的key是地域/车系/人群定向等，value是bitmap（长度5W，目前广告位千级别，若某广告能被key触发，则相应位移的值为1）</li>
<li>多个倒排链之间广告位id位移一致</li>
<li>正排数据是一个指针数组，广告位顺序和倒排链一致</li>
<li>enable数组标识广告的有效性，广告位顺序和正派，倒排链一直</li>
<li>若广告位无效，先置enable数组中该广告位为无效，倒排链中相关位置为0，正排数据中指针指向的内存标记为old，</li>
<li>轮询时会将无效的old数据清空，有新广告位进来会占用之前无效的广告位位置</li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> 染色系统分享</li>
<li>业务需求<ul>
<li>试金石，对流量按一定的比例进行实验，支持层级间独立以及灰度发布<br><img src="./染色系统.png" alt="Alt text"></li>
<li>灰度发布 <strong>实验通过后走灰度发布流程</strong><ul>
<li>10%，30%，60%</li>
<li>cookie mod或者random</li>
</ul>
</li>
<li>实验 <strong>优先级最高，可以覆盖灰度发布命中的配置</strong><ul>
<li>混叠区（从各自的实验流量里面抽取部分做对照）</li>
<li>独占区（5层实验，这部分流量只想做实验1，3层，其他层不做实验）<br><img src="./1492137199771.jpg" alt="Alt text"></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>###0412</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 串讲</li>
<li>串讲时有点紧张，细节还是有点了解不充分，文档的时效性不高，在以后的工作中要多和同事交流，尤其是广告业务，架构是应业务的发展不断升级，不了解业务谈何架构优化升级</li>
<li>广告的交易方式，DSP，车智投还需要进一步了解</li>
<li style="list-style: none"><input type="checkbox"> lua</li>
<li>require机制</li>
<li>lua继承</li>
<li>多级元表</li>
<li>table机制的对象实现</li>
</ul>
<p>###0411</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 复习golang workpool，垃圾回收等代码</li>
<li style="list-style: none"><input type="checkbox"> 在线快速学习lua，为下一步开发做准备<br>###0410</li>
<li style="list-style: none"><input type="checkbox"> 修正adx串讲PPT中存在的问题，细化部分概念，发邀请邮件</li>
<li style="list-style: none"><input type="checkbox"> 确认InMobi网盟API接口部分字段取值，已落地文件并发邮件<br>##20170405-20170407<br>###0407</li>
<li style="list-style: none"><input type="checkbox"> lua入门</li>
<li>语法知识</li>
<li style="list-style: none"><input type="checkbox"> 调研InMobi网盟API接口文档</li>
<li>了解输入输出</li>
<li>了解各字段含义</li>
<li>了解Native/Banner/Interstitial区别</li>
<li>了解调用注意事项<br>###0406</li>
<li style="list-style: none"><input type="checkbox"> 完成串讲材料准备</li>
<li>了解PDB,PA,PD等概念</li>
<li>程序化广告交易<ul>
<li>参与方：<ul>
<li>广告主/广告代理公司：对目标人群针对性的投放，注重转化率</li>
<li>媒体平台：流量收益最大化</li>
<li>用户：减少广告对用户体验的伤害</li>
</ul>
</li>
<li>目的：在合适的时间，通过合适的载体，以合适的方式，对合适的用户投放合适的广告</li>
<li>整个投放过程自动化，流程化，系统化</li>
<li>投放效果报表</li>
<li>对每一曝光机会竞价，买用户（传统方式：买断广告位）</li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> 调研codis-proxy超时 </li>
<li>参与App端联盟合作PRD评审</li>
<li>搭建OpenResty开发环境，学习lua开发语言<br>###0405</li>
<li style="list-style: none"><input type="checkbox"> 准备adx串讲材料</li>
<li>ppt大纲搭建</li>
<li>完成2/3<ul>
<li>adx介绍</li>
<li>adx业务</li>
<li>在之家的发展<ul>
<li>流量特点以及根据流量特点适配售卖方式</li>
</ul>
</li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> 调研go gc机制，处理redis超时问题</li>
<li>引用计数法</li>
<li>mark-swap go1.5以前</li>
<li>三色标记法</li>
<li>分代法</li>
</ul>
<p>##20170327-20170331</p>
<p>###0331</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 编译proxy3plus，试运行，测试下高并发请求下的gc情况<br>完成编译proxy3plus，了解代码运行机制</li>
<li><p>main.go</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//启动http服务</span></span><br><span class="line">http.HandleFunc(<span class="string">"/setloglevel"</span>, handleSetLogLevel)</span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">	err := http.ListenAndServe(httpAddr, <span class="literal">nil</span>)</span><br><span class="line">	log.PanicError(err, <span class="string">"http debug server quit"</span>)</span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line"><span class="comment">//初始化proxy对象</span></span><br><span class="line">s := proxy.New(addr, httpAddr, conf)</span><br></pre></td></tr></table></figure>
</li>
<li><p>proxy.go</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//请求处理入口</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *Server)</span> <span class="title">serve</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">defer</span> s.<span class="built_in">close</span>()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//初始化slot</span></span><br><span class="line">	s.router.FillClusterSlot()</span><br><span class="line"></span><br><span class="line">	log.Info(<span class="string">"proxy is serving"</span>)</span><br><span class="line">	<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		<span class="keyword">defer</span> s.<span class="built_in">close</span>()</span><br><span class="line">		<span class="comment">//受理新连接</span></span><br><span class="line">		s.handleConns()</span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//心跳，监听kill信号</span></span><br><span class="line">	s.loopEvents()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>route.go</p>
</li>
<li>session.go</li>
<li><p>redis.go</p>
</li>
<li><p>[ ] 看adx相关文档，准备串讲PPT</p>
</li>
<li>了解CPM,CPC,CPA,CPD,CPT等计费模式区别，梳理适用场景，从广告主，流量主，平台，用户等角度分析在不损害某一方利益的前提下收益最大化<ul>
<li>流量主希望CPM，不浪费每一个流量</li>
<li>广告主希望CPA，更愿意为每一次行为付费</li>
<li>CPM更适合品牌推广，CPC适合竞价推广，CPA适合应用分发</li>
</ul>
</li>
<li><p>熟悉之家广告业务模式</p>
<ul>
<li>品牌广告<ul>
<li>车智投平台</li>
<li>CPD &amp; 保量CPM</li>
<li>广告主通过商务合作形式敲定具体广告位的排期（有冲突则后延），设置投放属性，请求过来时（广告位信息，属性等）过滤后再展现</li>
<li>内推广告（车商城，二手车等）在特定时间（双11）也可以自动升级为品牌广告</li>
<li>PDB占位，然后转发给DSP处理</li>
<li>广告位规定售卖方式（CPM,CPD,CPC等）</li>
</ul>
</li>
<li>DSP<ul>
<li>之家DSP，未来对接更多的DSP</li>
<li>CPC</li>
<li>具体的广告位映射到具体的DSP</li>
</ul>
</li>
<li>网盟</li>
<li>内推 &amp; 保底 <ul>
<li>内推：车商城 &amp; 二手车</li>
<li>保底：论坛</li>
</ul>
</li>
</ul>
</li>
<li><p>[ ] 值班维护线上redis集群<br><strong>没有报警,一切正常,没有迁移需求,提供测试环境</strong><br>###0330</p>
</li>
<li style="list-style: none"><input type="checkbox"> 编译redis3plus，proxy3plus</li>
<li style="list-style: none"><input type="checkbox"> 值班维护线上redis集群<br><strong>没有报警,一切正常,没有迁移需求,提供测试环境</strong></li>
<li style="list-style: none"><input type="checkbox"> 了解搜索推广，网盟推广，DSP,RTB,DMP,SSP,ADX等概念</li>
<li>通过购买关键词，用户搜索的query若匹配关键词，则按照bid X q顺序展现 <em>匹配度高</em></li>
<li>通过对中小网站指定人群，网站，关键词等的广告投放 <em>覆盖广</em></li>
<li>DSP 需求平台 <strong>广告管理平台，广告主设置投放时间，人群属性等</strong></li>
<li>RTB 实时竞价 <strong>结合广告位，用户画像等信息，参与实时竞价</strong></li>
<li>DMP 数据管理中心 <strong>挖掘用户属性，提供用户画像</strong></li>
<li>SSP 资源平台 <strong>提供广告位，流量资源到广告交易平台，接受adx返回的广告内容并展现</strong></li>
<li>ADX 广告交易平台 <strong>将SSP的流量分发到多个DSP进行竞价，返回价高者的广告到站点</strong><br>###0329</li>
<li style="list-style: none"><input type="checkbox"> 继续学习go</li>
<li>学习剩下章节</li>
<li>异常处理,时间,json,ash1加密,mutex等</li>
<li style="list-style: none"><input type="checkbox"> adexchange分享准备</li>
<li>了解行业中公有,私有adx代表</li>
<li>了解程序化广告购买概念</li>
<li style="list-style: none"><input type="checkbox"> 值班维护线上redis集群<br><strong>没有报警,一切正常,没有迁移需求,提供测试环境</strong></li>
</ul>
<p>###0328</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 零基础入门go</li>
<li>总共65个小结,已学习35个小结</li>
<li>输出hello world,了解依赖包,build,run,install</li>
<li>变量,if/for/switch,数组,分片,map,函数,可变函数,闭包,method,interface,递归,遍历,gorouterine,channel,timer,workpool</li>
<li>天生的多线程处理基因,gorouterine/channel配合解决大部分问题</li>
<li>gc机制管理内存</li>
<li>强大的功能库</li>
<li>交叉编译机制,一次编译到处运行</li>
<li style="list-style: none"><input type="checkbox"> 值班维护线上redis集群<br><strong>没有报警,一切正常,没有迁移需求</strong></li>
<li style="list-style: none"><input type="checkbox"> adexchange分享准备<br><em>准备大纲what/why/how</em></li>
</ul>
<p>###0327</p>
<ul>
<li style="list-style: none"><input type="checkbox" checked> 验证proxy+server部署在一台服务性能损耗</li>
<li><p>目前线上每天有2-3次超时请求</p>
<ul>
<li>redis内部没有slow操作</li>
<li>监控显示超时期间服务器状态ok,各项指标正常</li>
<li>推测proxy内部处理问题,待验证,需要熟悉go<br><em>proxy3plus基本上拷贝的是codis代码,去掉了zookeeper交互逻辑,并增加了对redis3集群的操作</em></li>
</ul>
</li>
<li><p>[x] 值班维护线上redis集群<br><strong>没有报警,一切正常,没有迁移需求</strong></p>
</li>
<li style="list-style: none"><input type="checkbox"> 熟悉python运行原理</li>
<li>熟悉adx业务,架构,请求处理流程,数据流<ul>
<li>adx是广告分发平台,上游是web/app,下游有车智投,DSP,联盟等</li>
<li>adx-center负责广告位,素材,dsp平台等信息的推送,以及负责qps配额</li>
<li>adx-service负责响应前段请求,并请求下游获取广告id,并进行竞价,去重,拼装等</li>
<li>adx-service将web提供的点击,展现日志保存下来,供算法,大数据分析投放效果,并将点击操作同步到计费模块,按展现计费<br><img src="./1490663551314.png" alt="Alt text"></li>
</ul>
</li>
</ul>
<p>##20170320-20170324</p>
<p>###20170320</p>
<ul>
<li style="list-style: none"><input type="checkbox" checked> 验证proxy+server部署在一台服务性能损耗</li>
<li style="list-style: none"><input type="checkbox" checked> 利用web页面部署redis集群’<br>请假<br>###20170321</li>
<li style="list-style: none"><input type="checkbox"> 了解线上redis部署情况<ul>
<li>操作线上新增节点slot迁移</li>
<li>操作线下测试环境(新增rdis实例，启动，停止redis服务，加入集群，slot迁移)</li>
<li>开发及环境部署redis集群，各种操作试了一遍</li>
<li>cluster-require-full-coverage设置成no后，主节点从节点挂了只是影响本机覆盖的slot部分</li>
<li><strong>不要想当然的觉得设计有问题，一定要多问几个为什么，有一定经验的架构师会考虑的很全面的，尤其是紧跟业务</strong></li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> 熟悉redis集群灾备机制</li>
<li style="list-style: none"><input type="checkbox"> <a href="https://03k.org/kms.html" target="_blank" rel="noopener">激活win7专业版</a><br>###20170322<ul>
<li style="list-style: none"><input type="checkbox"> 熟悉proxy模块设计<br><img src="./1490235064044.png" alt="Alt text"></li>
<li>redis2</li>
<li>redis3 <strong>redis2 + 维护redis路由表信息</strong><br><img src="./1490234979361.png" alt="Alt text"></li>
<li>proxy2 <strong>proxy2接收客户端请求,hash(key)后找到对应的redis服务,类似于codis</strong></li>
<li>proxy3 <strong>proxy2功能类似,增加了对move,ask的redis服务应答处理</strong></li>
<li style="list-style: none"><input type="checkbox"> 配置vim插件</li>
<li><a href="https://github.com/ma6174/vim" target="_blank" rel="noopener">推荐插件配置</a><ul>
<li>自动补齐</li>
<li>winmanager + taglist + filebuffer + 注释</li>
<li>增加a.vim + git-diff + doxtokit等插件</li>
<li>ctags</li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> 登录兆维机房,熟悉线上环境 <em>没有权限,基本没啥鸟用,还漏申请了一些机器</em></li>
<li style="list-style: none"><input type="checkbox"> 熟悉redis集群内部机制</li>
<li>节点<ul>
<li>持有键值对数据 <em>最基本的功能</em></li>
<li>记录集群状态,持有slot到node的映射 <em>代看着点其他节点 &amp;&amp; 管着点slot和node的闲关系</em></li>
<li>紧急处理集群事宜 <em>随时通告自己所知道的,必要时可能会升级</em></li>
<li>gossip协议集群通信</li>
</ul>
</li>
<li>选举机制<ul>
<li>什么时候开始选举 <em>master fail &amp;&amp; master有slot &amp;&amp; slave ok</em></li>
<li>谁能参加选举 <em>相应的master fail &amp;&amp; 状态OK</em></li>
<li>谁能成为master <em>ecpoh值最小的(工号最小)</em></li>
<li>成为master后要做什么 <em>主动广播 &amp;&amp; master标识 &amp;&amp; 接管slot</em></li>
<li>其他slave需要做什么 <em>认命 &amp; 同步 &amp; 老的master自动降级</em></li>
</ul>
</li>
<li>Move <em>永久性迁移</em></li>
<li>Ask <em>写操作临时处理</em></li>
<li>如何判断节点Fail <em>大家认为你是才真的是</em><ul>
<li>主节点在故障迁移完成前完成重启可以取消FAIL</li>
</ul>
</li>
<li>如何介绍新节点(CLUSTER MEET) <em>熟人介绍好办事</em></li>
<li>集群在线重配置<ul>
<li>CLUSTER ADDSLOTS slot1 [slot2] … [slotN]</li>
<li>CLUSTER DELSLOTS slot1 [slot2] … [slotN]</li>
<li>CLUSTER SETSLOT slot NODE node</li>
<li>CLUSTER SETSLOT slot MIGRATING node</li>
<li>CLUSTER SETSLOT slot IMPORTING node<br>###20170323</li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> 熟悉proxy代码</li>
<li style="list-style: none"><input type="checkbox"> 机房维修,可能断电</li>
</ul>
<ol>
<li>需要确认部署redis的机器启动了autoredis-agent。启动autoredis-agent</li>
<li>192.168.6.60 启动mysql</li>
<li>启动zookeeper</li>
<li>192.168.6.61<ul>
<li>启动web服务 <strong>cd /root/autoredis_manager &amp;&amp; nohup python2.7 web_main.py &amp;</strong></li>
<li><strong>cd  /root/autoredis_guardian &amp;&amp; nohup sh every_one_min.sh &amp;</strong></li>
<li>启动持久化的从节点<ul>
<li>grep config= /root/autoredis_guardian/redis_cluster_guardian.log(获取从节点列表)</li>
</ul>
</li>
<li>启动主节点(降级为从节点)</li>
</ul>
</li>
</ol>
</li>
</ul>
<p>##20170314-20170317</p>
<p>###20170314</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 熟悉编译环境，git代码，vim配置等</li>
<li>没有git权限</li>
<li>vim已配置好</li>
<li><p>[ ] 了解分布式kv缓存系统<br><img src="./分布式kv缓存系统.png" alt="Alt text"></p>
</li>
<li><p>redis版本差异(历史原因，内部升级3.0，对外不好强制升级)</p>
</li>
<li>交互方式差异(redis3.0支持集群，codis方案可以去掉zk)</li>
<li>go 1.5.2 gc问题导致超时问题(建议使用1.5.3&amp;1.7.1版本)</li>
<li style="list-style: none"><input type="checkbox"> 了解目前存在的问题，带着问题去了解redis 3.0</li>
</ul>
<hr>
<ul>
<li><p>代码规范</p>
<ul>
<li>不建议使用类封装不使用静态成员变量的静态成员函数，建议使用命名空间；</li>
<li>命名规则<strong>小写_小写</strong></li>
<li>头文件包含顺序<br>cpp文件对应的.h文件(<strong>避免隐含依赖</strong>)-&gt;c库.h-&gt;c++库.h-&gt;通用库.h-&gt;本工程其他.h</li>
<li>while,swith,析构函数不建议内联</li>
<li>构造函数内初始化确定ok的成员变量，顺序与声明顺序一致，不能使用虚函数</li>
<li>接口参数合法性检查在接口函数内部执行(<strong>对外接口建议这样，内部流程建议谁调用谁检查，避免无谓的函数调用开销</strong>)</li>
</ul>
</li>
<li><p>threadpool并行库</p>
<ul>
<li>CTP_TASK定义接口，TASK类实现handle,getData,getResult等接口</li>
<li>Executor工作任务推模式，避免拉模式抢锁(<strong>选择闲置线程需要锁处理</strong>)</li>
<li>getResult利用条件锁等待结果处理(<strong>如果业务能使用异步机制，可以代替</strong>)</li>
<li>threadpool封装阻塞队列，相比队列+线程池的实现可以感知队列负载，做降级等处理，但复用性相对较差</li>
<li>上游需要处理队列满导致executor失败的异常情况</li>
</ul>
</li>
<li><p>内存缓存调研</p>
<ul>
<li>LRU<br>保留最近使用热点数据，批量处理容易带来数据噪点</li>
<li>LFU<br>保留最近一段时间频次较高的热点数据，曾经多次使用的数据保留下来</li>
<li>Adaptive Replacement Cache<br>通常由一个LRU和一个LFU组成，LFU用于记录使用次数超过两次的条目，程序通过统计LFU miss次数来动态调整LRU和LFU长度（总长固定）</li>
<li>Two queues<br><img src="./two-queues.png" alt="Alt text"></li>
</ul>
</li>
</ul>
<ul>
<li>异步日志系统<br><img src="./异步日志系统.png" alt="Alt text"></li>
</ul>
<ul>
<li>AsyncLogHandler<br>API,提供对外接口，若调用失败直接将日志写入本地</li>
<li>AsyncTaskHelper<br>初始化，异步任务框架的对外接口</li>
<li>Consumer<br>管理工作线程，根据负载做一定调整</li>
<li>Policy<br>入队出队的一些策略，重试次数等</li>
<li>WorkThread</li>
<li>LockFreeQueue<br>无锁循环队列</li>
<li>Task<br>继承CTaskHandlerBase，实现handle</li>
<li>Log4cppWriter</li>
</ul>
<hr>
<p>###20170315</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 已获取git权限，下载代码，make&amp;build<ul>
<li>/home/w是工程依赖库路径，生产环境是依赖动态库，动态库保证向前兼容</li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> 熟悉监控运维平台使用<ul>
<li>配置<br>业务配置-&gt;功能模块-&gt;关联主机、报警策略、关联模板-&gt;模板添加策略</li>
<li>图形监测<br>选择你关心的机器，监控项监控</li>
</ul>
</li>
<li style="list-style: none"><input type="checkbox"> 继续探讨autoredis升级方案<br><img src="./autoredis目前状况.png" alt="Alt text"></li>
</ul>
<ul>
<li>熟悉目前反馈的case<ul>
<li>redis 3.0服务集群<strong>主读写、从持久化</strong><ul>
<li>客户端保持与主、从的长连接，如果连接发生超时，断开等事件，会通知特定线程轮训路由表，若发现主节点挂掉(3s后从节点自动升级为主节点)，客户端reset主机连接，3s后重新建立与新主节点的长连接</li>
<li>若节点部署机器损坏，节点nodes.conf文件丢失，需要顺序执行add slot-&gt;set-epoch-config-&gt;meet-&gt;forget</li>
<li>组内只有一台redis服务的，若挂掉重启，对数据高可用性要求不高</li>
</ul>
</li>
<li>redis 2.0服务集群<strong>主读写，从读+持久化</strong>，若主节点挂掉，proxy发现从节点的同步状态为-1，就默认该组发生故障</li>
</ul>
</li>
</ul>
<hr>
<p>###20170316</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 使用并了解redis3.0集群，通过web页面部署使用，添加节点，删除节点，slot迁移等场景覆盖 </li>
<li>查看使用手册，了解性能测试报告</li>
<li>熟悉redis使用场景</li>
<li>比对proxy中run_with_key与run的差异</li>
<li>熟悉redis同步原理，reactor模式</li>
<li>对比auto_redis，codis方案</li>
<li style="list-style: none"><input type="checkbox"> 熟读redis设计与实现关于集群的设计原理，包括同步，持久化等对性能的损耗</li>
</ul>
<hr>
<p>###20170317</p>
<ul>
<li style="list-style: none"><input type="checkbox"> 熟读redis设计与实现关于集群的设计原理，包括同步，持久化等对性能的损耗</li>
<li>了解熟悉redis部分不常用命令</li>
<li>熟悉redis同步，持久化，订阅/发布机制</li>
<li>开发及部署redis集群，测试运行部分命令<hr>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/12/14/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zhoufan23">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="慢慢的脚步">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/12/14/hello-world/" itemprop="url">Hello World</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-14T17:50:23+08:00">
                2017-12-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">zhoufan23</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zhoufan23</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
